(self.webpackChunk=self.webpackChunk||[]).push([[5739],{70632:(e,t,n)=>{var r=n(98544),a="chrome-extension://__MSG_@@extension_id__/",i="moz-extension://__MSG_@@extension_id__/",o="safari-web-extension://__MSG_@@extension_id__/",s=self.GR_RESOURCE_ROOT||a,c=self.GR_RESOURCE_ROOT||i,l=self.GR_RESOURCE_ROOT||o;e.exports={__css:r.toString().replace(new RegExp(a,"g"),s).replace(new RegExp(i,"g"),c).replace(new RegExp(o,"g"),l),...r.locals}},21946:(e,t,n)=>{n.r(t),n.d(t,{EditsTrackingControllerImpl:()=>Rn});var r=n(90023),a=n(82823),i=n(36072),o=n(65647),s=n(78488),c=n(55446),l=n(60841),d=n(73863),u=n(8748),h=n(58303),m=n(68259),p=n(25770),g=n(8754),f=n(42818),k=n(97001),b=n(79409),v=n(45661),_=n(46356),y=n(66241),C=n(72616),w=n(48822),x=n(64965),S=n(70163),E=n(70989),I=n(93899),T=n(52569),A=n(83780),B=n(74857),L=n(97697),D=n(20715),M=n(14765),R=n(78008),N=n(16692),P=n(18615),F=n(88241);const G="document_state",U="document_state_enc";class O extends Error{constructor(e,t){super(e),this._reason=t}get reason(){return this._reason}}class H extends O{}class j extends O{}class W extends O{}class Z extends O{}class z extends O{}class $ extends Z{}function V(e,t=Z){return e instanceof O?e:new t(e.message,e)}var K,Y,q,Q;!function(e){let t;!function(e){e.create=function(e){return{timestamp:e.timestamp,delta:e.delta,copyContentId:e.sourceContentId,isSelfAuthored:e.isSelfAuthored}},e.parse=function(e){try{const t=e;return t.timestamp&&!isNaN(t.timestamp)&&t.delta?{timestamp:Number(t.timestamp),delta:t.delta,sourceContentId:t.copyContentId?String(t.copyContentId):void 0,isSelfAuthored:t.isSelfAuthored}:null}catch(e){return null}}}(t=e.Legacy||(e.Legacy={})),e.is=function(e){return null!==e}}(K||(K={})),function(e){let t,n;!function(e){e.create=function(e){return{timestamp:e.timestamp,text:e.char,copiedContentId:void 0!==e.sourceContentId&&null!==e.sourceContentId&&""!==e.sourceContentId?e.sourceContentId:void 0,isSelfAuthored:e.isSelfAuthored}},e.parse=function(e){try{const t=e;return void 0!==t.text&&t.text.length&&t.timestamp&&void 0!==t.isSelfAuthored?{char:String(t.text),timestamp:Number(t.timestamp),sourceContentId:t.copiedContentId?String(t.copiedContentId):void 0,isSelfAuthored:Boolean(t.isSelfAuthored)}:null}catch(e){return null}}}(t=e.Legacy||(e.Legacy={})),function(e){e.create=function(e){return{character:e.char,timestamp:e.timestamp,sourceContentId:e.sourceContentId,isSelfAuthored:e.isSelfAuthored}}}(n=e.Backend||(e.Backend={})),e.is=function(e){return null!==e}}(Y||(Y={})),function(e){let t;e.create=function(e,t,n,r,a){let i=[],o=[],s=[];return r&&((0,m.kG)(n.length==r.length,`Expected that the text length ${n.length} be the same as the Char[] length ${r.length}`),i=r.map((e=>e.timestamp)),o=r.map((e=>e.isSelfAuthored)),s=r.map((e=>e.sourceContentId||null))),{id:crypto.randomUUID(),url:e,sourceName:t,text:n,timestamps:i,isSelfAuthoredTags:o,originalSourceContentIds:s,prompt:a}},function(e){e.create=function(e){return{id:e.id,url:e.url,sourceName:e.sourceName,text:e.text,timestamps:e.timestamps,isSelfAuthoredTags:e.isSelfAuthoredTags,originalCopiedContentIds:e.originalSourceContentIds,prompt:e.prompt||null}},e.parse=function(e){try{const t=e;if(t.id&&t.url&&t.sourceName&&t.text&&Array.isArray(t.timestamps)&&Array.isArray(t.isSelfAuthoredTags)&&Array.isArray(t.originalCopiedContentIds)){const e=t.timestamps.filter((e=>!isNaN(e))),n=t.isSelfAuthoredTags.map(Boolean),r=t.originalCopiedContentIds.filter((e=>null===e||"string"==typeof e));return e.length===n.length&&n.length===r.length?{id:t.id,url:t.url,sourceName:t.sourceName,text:t.text,timestamps:e,isSelfAuthoredTags:n,originalSourceContentIds:r,prompt:t.prompt||void 0}:null}return null}catch(e){return null}}}(t=e.Legacy||(e.Legacy={})),e.is=function(e){return null!==e}}(q||(q={})),function(e){let t,n;e.empty=function(e){return{id:e,chars:[],sourcedContentStore:{kind:"internal",data:[]},deltaEdits:[]}},function(e){e.create=function(e){return{id:e.id,chararray:e.chars.map(Y.Legacy.create),copyStore:{storeType:e.sourcedContentStore.kind,data:e.sourcedContentStore.data.map(q.Legacy.create)},deltas:e.deltaEdits.map(K.Legacy.create)}},e.parse=function(e){try{const t=e;if(t.id&&Array.isArray(t.chararray)&&t.copyStore&&t.copyStore.storeType&&Array.isArray(t.copyStore.data)&&Array.isArray(t.deltas)){const e=t.chararray.map(Y.Legacy.parse).filter(Y.is),n=t.copyStore.data.map(q.Legacy.parse).filter(q.is),r=t.deltas.map(K.Legacy.parse).filter(K.is);return e.length!==t.chararray.length||n.length!==t.copyStore.data.length||r.length!==t.deltas.length?null:{id:t.id,chars:e,sourcedContentStore:{kind:t.copyStore.storeType,data:n},deltaEdits:r}}return null}catch(e){return null}}}(t=e.Legacy||(e.Legacy={})),function(e){e.create=function(e,t,n){return{documentId:e.id,chars:e.chars.map(Y.Backend.create),sourcedContentStore:{kind:e.sourcedContentStore.kind,data:e.sourcedContentStore.data},deltaEdits:e.deltaEdits,title:n}}}(n=e.Backend||(e.Backend={}))}(Q||(Q={}));const J="AES-GCM",X={name:J},ee={length:256,...X};function te(e){return{iv:e,...X}}function ne(){if(!self.crypto)throw new Z("Crypto API is not supported in this browser")}async function re(e){ne();const t=await self.crypto.subtle.exportKey("raw",e);return new Uint8Array(t)}var ae=n(46384);class ie{static ofRequest(e){return new Promise(((t,n)=>{e.onsuccess=n=>t(e.result),e.onerror=t=>n(e.error)}))}static ofTransaction(e){return new Promise(((t,n)=>{e.oncomplete=e=>t(),e.onerror=t=>n(e.error)}))}}function oe(e){return t=>`${e}-${t}`}function se(e){return function(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].toString(16).padStart(2,"0");return t.join("")}((0,ae.Bk)((new TextEncoder).encode(e)))}class ce{serialize(e){return Promise.resolve(Q.Legacy.create(e))}deserialize(e){const t=Q.Legacy.parse(e);return t?Promise.resolve(t):Promise.reject(new j("Document could not be parsed"))}}class le{constructor(e,t){this.keychain=t,this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder,this.uniqId=oe(e)}async serialize(e){try{const t=await this.keychain.getOrProvisionKey(e.id),n=JSON.stringify(e),r=this.textEncoder.encode(n),a=await async function(e,t){ne();const n=self.crypto.getRandomValues(new Uint8Array(12));return{iv:n,encrypted:await self.crypto.subtle.encrypt(te(n),t,e)}}(r,t);return{id:this.uniqId(e.id),documentId:e.id,data:a}}catch(e){throw V(e,Z)}}async deserialize(e){const{documentId:t,data:n}=e,r=await this.keychain.getKey(t);if(!r)throw new j("Key not found for document");try{const e=await function(e,t){ne();const{iv:n,encrypted:r}=e;return self.crypto.subtle.decrypt(te(n),t,r)}(n,r);return JSON.parse(this.textDecoder.decode(e))}catch(e){throw V(e,j)}}}class de{constructor(e,t,n,r,a,i){this.userId=e,this.documentId=t,this.keychain=n,this._onReadSuccess=r,this._onReadError=a,this._onWriteResult=i,this._initialized=p.h.create(!1),this._encryptionSerializer=new le(this.userId,this.keychain),this._legacySerializer=new ce,this._log=F.Y.create("HWRStorage"),this.uniqId=oe(e)}async reload(){if(this._log.info("reload"),this._db=await this.openDb(),!this._db)return this._log.error("Cannot open db"),void this.onReadError(new $);try{const e=await this.fetchFromEncrypted(this._db);if(e)return void this._onReadSuccess(e);const t=await this.fetchFromLegacy(this._db);t?(await this.migrateToEncrypted(this._db,t),this._onReadSuccess(t)):this._onReadError(new H)}catch(e){this.onReadError(V(e))}finally{this._initialized.set(!0)}}async fetchFromEncrypted(e){const t=this.uniqId(this.documentId),n=e.transaction([U],"readonly"),r=n.objectStore(U),a=await ie.ofRequest(r.get(t));return await ie.ofTransaction(n),a?await this._encryptionSerializer.deserialize(a):null}async fetchFromLegacy(e){if(!e.objectStoreNames.contains(G))return null;const t=this.documentId,n=e.transaction([G],"readonly"),r=n.objectStore(G),a=await ie.ofRequest(r.get(t));return await ie.ofTransaction(n),a?await this._legacySerializer.deserialize(a):null}async migrateToEncrypted(e,t){this._log.info("Migrating document to encrypted storage");try{const n=t.id,r=await this._encryptionSerializer.serialize(t),a=e.transaction([U,G],"readwrite");a.objectStore(U).put(r),a.objectStore(G).delete(n),await ie.ofTransaction(a)}catch(e){const t=(0,b.Tb)().humanWritingReport,n=(null==e?void 0:e.message)||"Unknown error";throw t.error("storageError",`Couldn't migrate document to encrypted storage: ${n}`),V(e)}}async writeDocumentState(e){if(await this.isInitialized(),this._db)try{const t=await this._encryptionSerializer.serialize(e),n=this._db.transaction([U],"readwrite");n.objectStore(U).put(t),await ie.ofTransaction(n),this._onWriteResult("success")}catch(e){return void this._onWriteResult("error",V(e))}else this._onWriteResult("error",new $)}isInitialized(){return this._initialized.pipe(c.h((e=>e)),P.P()).toPromise()}async openDb(){const e=indexedDB.open("human_writing_report",2);e.onupgradeneeded=this.onUpgradeNeeded.bind(this);try{return await ie.ofRequest(e)}catch(e){return null}}onUpgradeNeeded(e){const t=e.target,n=t.result;if(t.result&&t.transaction)try{n.objectStoreNames.contains(U)||n.createObjectStore(U,{keyPath:"id",autoIncrement:!1})}catch(e){this._onReadError(V(e))}else this._onReadError(new $)}onReadError(e){e instanceof j&&this._log.error(`Database corrupted: userId: ${this.userId} documentId: ${this.documentId}, (${e.name}) ${e.message}`),this._onReadError(e)}}var ue=n(97521);class he{constructor(e){this._client=e}async getKey(e){const t=he.createKeyId(e),n=await this.fetchKey(t);if(!n)return null;const r=(0,ue.K9)(n);return await function(e,t=!1,n=["encrypt","decrypt"]){return ne(),self.crypto.subtle.importKey("raw",e,J,t,n)}(r)}async getOrProvisionKey(e){let t=0;for(;t<=3;)try{return await this.getKey(e)||await this.provisionKey(e)}catch(e){if(e instanceof z){if(t++<=2)continue;if(e.reason)throw V(e.reason,Z);throw new Z("Too many retries")}throw V(e)}throw new Z("Too many retries")}async provisionKey(e){const t=he.createKeyId(e),n=await(ne(),self.crypto.subtle.generateKey(ee,!0,["encrypt","decrypt"]));return await this.storeKeys([{keyId:t,key:n}]),n}static createKeyId(e){return se("key-"+e)}async fetchKey(e){const t=await this._client.getEncryptionKey({keyId:e});return null==t?void 0:t.keyMaterial}async storeKeys(e){const t=[];for(const n of e){const e=await re(n.key);t.push({id:n.keyId,keyMaterial:(0,ue.J2)(e)})}await this._client.createEncryptionKeys({keys:t})}}var me=n(62617),pe=n(18820),ge=n(56195),fe=n(42530),ke=n(72525),be=n(39408),ve=n(87175);const _e=n(72138);class ye{constructor(){this._rpc=(0,v.OB)().bgRpc,this._log=F.Y.create("GoogleDocsSourcedContentStore")}async getMatch(e,t,n,r){let a=null;return r.deleted.length>0&&RegExp(`^${r.deleted[0].toUpperCase()}${r.deleted.substring(1)}\\s$`).test(r.inserted)||/\S\s$/.test(r.inserted)&&_e(r.inserted,r.deleted)<=r.deleted.length/1.5?a=q.create("hwr://delta/rewrite/google/correct/","Google Docs Corrections",e):0==me.QY.getNumDeletedLetters(t)&&me.QY.getNumInsertedLetters(t)<=ge.QU&&(a=await this._matchPhraseCompletion(e,n)),this._log.debug(`[GoogleDocsSuggestionStore] getMatch('${e}') returning:`,a),a}async _matchPhraseCompletion(e,t){let n=null,r=null;if(null!=this._rpc.api.autocompletePhrase&&(r=await this._rpc.api.autocompletePhrase(t)),null!=r){const t=r.text.substring(r.prefixBegin-r.textBegin,r.prefixEnd-r.textBegin),a=r.text.substring(r.prefixEnd-r.textBegin),i=r.text.substring(t.length);(a==e||a.startsWith(e)||e.startsWith(a))&&(this._log.debug(`[GoogleDocsSuggestionStore] match: ${e} response: ${i}`),n=q.create("hwr://delta/rewrite/google/completion/","Google Docs Smart Compose Suggestions",e))}return n}}var Ce,we=n(5056);!function(e){e.Internal="internal",e.Selection="selection",e.GrammarlyPrevious="grammarly-previous",e.GrammarlyCurrent="grammarly-current",e.External="external",e.GDocs="gdocs",e.Startup="startup",e.Temporary="temporary",e.Test="test"}(Ce||(Ce={}));class xe{constructor(e,t=[],n=1/0){this.kind=e,this.data=t,this._maxRecordsCount=n,this._sourcedContentById=new Map,this.data.forEach((e=>{this._sourcedContentById.set(e.id,e)})),this._log=F.Y.create(`[${this.kind}] ${xe.name}`),this._keepLastN()}getMatch(e,t){var n;let r=this.data;t&&(r=this.data.filter(t));const a=r.find((({text:t})=>t===e))||null;return null===(n=this._log)||void 0===n||n.info(`[${this.kind}] getMatch('${(0,me.aS)(e,40)}') returning:`,a),a}getFuzzyMatch(e,t){var n;const r=(1-t)*e.length,a=this.data.find((t=>{var n,a;const i=(0,me.CZ)(t.text),o=we.zI.diffAsChanges(i,e);return null===(n=this._log)||void 0===n||n.info(`[FuzzyMatch] text length: ${e.length}, amount changed: ${o.amount}`),null===(a=this._log)||void 0===a||a.info("Delta",o),o.amount<=r&&!me.Hq.hasPerLetterTags(t)}))||null;return null===(n=this._log)||void 0===n||n.info(`[${this.kind}] getFuzzyMatch('${(0,me.aS)(e,40)}') returning:`,a),a}getContentById(e){return this._sourcedContentById.get(e)||null}addContent(e){var t;null===(t=this._log)||void 0===t||t.debug("addContent",e),this.data.push(e),this._sourcedContentById.set(e.id,e),this._keepLastN()}_keepLastN(){this.data.length<=this._maxRecordsCount||(this.data.slice(0,this.data.length-this._maxRecordsCount).forEach((({id:e})=>{this._sourcedContentById.delete(e)})),this.data=this.data.slice(-this._maxRecordsCount))}}class Se{constructor(e,t,n,r,a){this.text=e,this.delta=t,this.timestamp=n,this.sourcedContent=r,this.isWholeDeltaSelfAuthored=a,null!=r&&r.timestamps.length>0&&((0,m.kG)(e.length==r.timestamps.length),(0,m.kG)(e.length==r.isSelfAuthoredTags.length),(0,m.kG)(e.length==r.originalSourceContentIds.length))}getCharAt(e){var t,n,r;const a=null!=this.sourcedContent?this.sourcedContent.timestamps:[],i=(null===(t=this.sourcedContent)||void 0===t?void 0:t.isSelfAuthoredTags)||[],o=(null===(n=this.sourcedContent)||void 0===n?void 0:n.originalSourceContentIds)||[];let s=this.timestamp;const c=this.isWholeDeltaSelfAuthored||!!this.sourcedContent&&Boolean(i[e]);let l=(null===(r=this.sourcedContent)||void 0===r?void 0:r.id)||null;return a.length>0&&(s=a[e],l=o[e]||l),{char:this.text[e],timestamp:s,sourceContentId:l||void 0,isSelfAuthored:c}}}function Ee(e,t,n){if(0===t.length)return 0;const r=(0,me.k4)(n,e,t);return r>0?r:e.ops.reduce(((e,r,a,i)=>{if(e.eventsIndex>=t.length)return a!==i.length-1||!("delete"in r)||"insert"in r&&""!==r.insert?{...e,matched:0,eventsIndex:e.eventsIndex}:e;if("retain"in r){const o=function(e,t,n=3){var r;let a=0;const i=Math.min(e.length,t.length,n)-1;for(let n=i;n>=0&&e[e.length-1-n]===(null===(r=t[i-n])||void 0===r?void 0:r.key);n--)a++;return a}(n.substring(0,e.textIndex+r.retain),t);if(o){let r=e.eventsIndex+o,s=e.textIndex+o;i.slice(a+1).every((e=>{var a;if("retain"in e){if(!(0,me.fo)(n.substring(s,s+e.retain),t.slice(r)))return!1;r+=e.retain,s+=e.retain}if("delete"in e){if(""!==(null===(a=t[r])||void 0===a?void 0:a.key)&&void 0!==t[r])return!1;r+=e.delete}if("insert"in e){const n=e.insert;if(!(0,me.fo)(n,t.slice(r)))return!1;r+=n.length}return!0}))&&(e.matched+=o,e.eventsIndex+=o)}e.textIndex+=r.retain}if("delete"in r&&r.delete>0)for(e.textIndex+=r.delete;e.eventsIndex<t.length&&""===t[e.eventsIndex].key;)e.matched+=1,e.eventsIndex+=1;if("insert"in r){const n=r.insert;if(!(0,me.fo)(n,t.slice(e.eventsIndex)))return{...e,matched:0,eventsIndex:e.eventsIndex};e.matched+=n.length,e.eventsIndex+=n.length}return e}),{matched:0,eventsIndex:0,textIndex:0}).matched}class Ie{constructor(e,t,n,r){this._documentId=e,this._events=t,this._trustedEvents=n,this._chars=[],this._last_updated_at=Date.now(),this._log=F.Y.create("ChangeTrackerImpl"),this._lastClientInfo=null;const{buildInfo:a,appConfig:i}=r.config;this._currentClientInfo={clientName:i.gnar.appName,version:a.version},this._deltaEdits=[],this._internalCopyStore=new xe(Ce.Internal,[]),this._internalSelectionStore=new xe(Ce.Selection),this._prevGrammarlyAlerts=new xe(Ce.GrammarlyPrevious),this._currentGrammarlyAlerts=new xe(Ce.GrammarlyCurrent),this._externalCopyStore=new xe(Ce.External,[],4),this._googleDocsSourcedContentStore=new ye,this.startupCopyStore=new xe(Ce.Startup,[],4)}async updateKnownDocumentState(e,t){this._chars=e.chars,this._internalCopyStore=new xe(Ce.Internal,e.sourcedContentStore.data),this._deltaEdits=e.deltaEdits,this._lastClientInfo=this._deltaEdits.reduce(((e,t)=>t.clientInfo?t.clientInfo:e),null);const n=me.QY.singleDelta(e.chars.map((e=>e.char)).join(""),t);me.QY.isNoTextChangesDelta(n)?(this._log.info("No changes since last known state."),this._events.next({kind:"knownStateMatch"})):(this._log.info("Known document state is different from current",n),this._events.next({kind:"knownStateMismatch",lengthDifference:Math.abs(me.QY.getNumInsertedLetters(n)+me.QY.getNumDeletedLetters(n))})),n.forEach((e=>{pe.s.isInsertString(e)&&this.startupCopyStore.addContent(q.create("hwr://delta/startup/","Delta on Document load",e.insert))})),await this.onTextChange(n)}async onTextChange(e){if(0===e.ops.length)return 0;const t=pe.s.normalizeDelta(pe.s.cleanAllAttrs(e));const n=Ee(t,this._trustedEvents.get(),this._chars.map((e=>e.char)).join(""));n||this._log.debug("delta is not authored",{squashedDelta:t,trustedEvents:this._trustedEvents.get()});const r=Date.now(),a=await this._applyDelta(t,r,n>0),i=me.QY.getNumInsertedLetters(t);if(!n&&a){const e=this._internalCopyStore.getContentById(a);e?this._events.next({kind:"sourcedTextAdded",sourceDomain:(0,me.Xw)(e.url),textLength:i,promptDetected:Boolean(e.prompt)}):this._events.next({kind:"unknownSourceTextAdded",textLength:i})}else n||this._events.next({kind:"unknownSourceTextAdded",textLength:i});const o={timestamp:r,delta:t,sourceContentId:a||void 0,isSelfAuthored:n>0,clientInfo:(0,fe.fS)(this._currentClientInfo,this._lastClientInfo)?void 0:this._currentClientInfo};return this._lastClientInfo=this._currentClientInfo,this._deltaEdits.push(o),this._last_updated_at=Date.now(),n}onSelectionChange(e){e.forEach((e=>{if(e.start!=e.end&&e.end-e.start>1){const t=this._chars.slice(e.start,e.end).map((e=>e.char)).join(""),n=this._chars.slice(e.start,e.end);this._internalSelectionStore.addContent(q.create(`hwr://delta/document/google/${this._documentId}`,self.name||"Unnamed",t,n)),this._events.next({kind:"sourceAdded",textLength:e.end-e.start,sourceDomain:self.location.origin,promptDetected:!1})}}))}onAlertChange(e){const t=new xe(Ce.Temporary);for(const[n,r]of Object.entries(e)){if(void 0===r||!be.S.isCapiAlert(r))continue;const e=r.text;r.replacements.forEach((r=>{const a=me.QY.extractMaximalReplacementString(e,me.QY.singleDelta(e,r));a&&t.addContent(q.create("hwr://delta/rewrite/grammarly/correct/?id="+n,"Grammarly edited: ("+e+" -> "+r+")",a))}))}me.Hq.eq(t.data,this._currentGrammarlyAlerts.data)||(this._prevGrammarlyAlerts=new xe(Ce.GrammarlyPrevious,this._currentGrammarlyAlerts.data),this._currentGrammarlyAlerts=new xe(Ce.GrammarlyCurrent,t.data))}addCopiedTextToExternalStore(e){if(!e.valid)return;const t=e.copiedText||"";null==this._externalCopyStore.getMatch(t)&&this._externalCopyStore.addContent(q.create(e.sourceURL||"",e.sourceName||"",t,void 0,e.userPrompt))}onReplacementApplied(e,t){if(e===ve.P.snippets||e===ve.P.oggyGenAI){let n="";void 0!==t.pos&&(n=this._chars.slice(t.pos.start,t.pos.end).map((e=>e.char)).join(""));const r=me.QY.extractMaximalReplacementString(n,"string"==typeof t.value?me.QY.singleDelta(n,t.value):t.value);r&&this._internalCopyStore.addContent(q.create("hwr://delta/rewrite/grammarly/"+e,"Grammarly generated ("+e+")",r))}}getDocumentState(){return{id:this._documentId,chars:this._chars,sourcedContentStore:{kind:"internal",data:this._internalCopyStore.data},deltaEdits:this._deltaEdits}}getReportableDocument(){return Q.Backend.create(this.getDocumentState(),this._last_updated_at,document.title)}getTextInfoForAlert(e){const t=[];return(0,ke.C)(e).forEach((e=>{if("transform"==e.meta.rangePurpose)for(let n=e.start;n<e.end;++n)t.push({...this._chars[n]})})),t}_applySingleDeletion(e,t){this._chars.splice(e,t)}_applySingleInsertion(e,t){const n=t.text.length,r=Array.from({length:n},((e,n)=>t.getCharAt(n)));this._chars.splice(e,0,...r)}async _searchAllCopyStores(e,t,n,r){let a=this._prevGrammarlyAlerts.getMatch(e);return a?{storeKind:Ce.GrammarlyPrevious,sourcedContent:a}:(a=this._internalCopyStore.getMatch(e,(e=>"hwr://delta/startup/"!=e.url)),a?{storeKind:this._internalCopyStore.kind,sourcedContent:a}:(a=this._internalSelectionStore.getMatch(e),a?{storeKind:Ce.Selection,sourcedContent:a}:(a=this._externalCopyStore.getMatch(e),a?{storeKind:Ce.External,sourcedContent:a}:(a=await this._googleDocsSourcedContentStore.getMatch(e,t,n,r),a?{storeKind:Ce.GDocs,sourcedContent:a}:(a=this.startupCopyStore.getMatch(e),a?{storeKind:Ce.Startup,sourcedContent:a}:(a=this._externalCopyStore.getFuzzyMatch(e,.95),a?{storeKind:Ce.External,sourcedContent:a}:null))))))}async _applyDelta(e,t,n){let a=null,i=0;const o=this._chars.map((e=>e.char)).join(""),s=me.QY.extractMaximalReplacementString(o,e),c=(0,r.zG)(pe.s.rangeOfTheChange(e),h.UI((([e])=>o.substring(0,e))),h.fS((()=>o)));let l=null;n||(l=s?await this._searchAllCopyStores(s,e,c,me.QY.getSummary(o,e)):null),a=(null==l?void 0:l.sourcedContent.id)||null,l&&l.storeKind!=Ce.Internal&&this._internalCopyStore.addContent(l.sourcedContent);for(const r of e.ops)pe.s.isRetain(r)?i+=r.retain:pe.s.isInsertString(r)?(this._applySingleInsertion(i,new Se(r.insert,e,t,(null==l?void 0:l.sourcedContent)||null,n)),i+=r.insert.length):pe.s.isDelete(r)&&(this._trackDeletion(i,r.delete),this._applySingleDeletion(i,r.delete));return a}_trackDeletion(e,t){const n=Array.from({length:t},((t,n)=>this._chars[e+n])),r=n.map((e=>e.char)).join("");this._onCopyDelete(r,n)}_onCopyDelete(e,t){e.length>=ge.Uv&&this._internalCopyStore.addContent(q.create(`hwr://delta/document/google/${this._documentId}`,self.name||"Unnamed",e,t))}onCopy(e){e.forEach((e=>{if(e.start!=e.end){const t=this._chars.slice(e.start,e.end).map((e=>e.char)).join(""),n=this._chars.slice(e.start,e.end);this._onCopyDelete(t,n)}}))}_getCSSFormatForLetter(e){const t="color: red;",n="color: black;",r=e.sourceContentId,a=null!=r?this._internalCopyStore.getContentById(r):null;let i;return i=null!=a?a.url.match(/delta\/rewrite\/grammarly\/(oggyGenAI|snippets)/)?"color: blue;":a.url.match("delta/rewrite/grammarly/correct")?"color: green;":a.url.match(/(chat.openai.com|chatgpt.com)/)?"color: purple;":a.url.match("gemini.google.com")?"color: orange;":a.url.match("delta/rewrite/google")?"color: teal;":a.url.match("delta/startup")?t:e.isSelfAuthored?n:t:e.isSelfAuthored?n:t,i}_logText(){const e=this._chars.map((e=>`%c${e.char}`)).join(""),t=this._chars.map((e=>this._getCSSFormatForLetter(e)));self.console.log(`HWR: ${e}`,...t)}}class Te{constructor(e,t,n,r,a,o,s,c,l,d,u){this._listenerId=e,this._alertsState=t,this._textObserver=n,this._selectionSource=r,this._CSState=a,this._replacementListener=o,this._events=s,this._encryptionService=c,this._errors=l,this._keyboardEventsSource=d,this._env=u,this._subs=new w.L,this._trackingState=p.h.create("dormant"),this._documentRetrievalState=p.h.create("waiting"),this._textChangeProcessingState=p.h.create("idle"),this._log=F.Y.create("HWRListenerImpl"),this._documentVisibilityObs=x.R(document,"visibilitychange").pipe(S.B()),this._documentStateSubj=new i.xQ,this._writeToStorageRequestSubj=new i.xQ,this._trustedEvents=p.h.create([]),this._integrationTestsEventsLogger=null;const h=(0,b.Tb)().humanWritingReport;this._setupKeyboardEventsHandling(),this._log.info("Document id",e);const m=new N.m;this._documentId=m.documentID||this._listenerId,this._changeTracker=new Ie(this._documentId,s,this._trustedEvents.view(),this._env);const g=a.view("user").view("id").get();this._keychain=new he(this._encryptionService),this._hwrStorage=new de(g,this._documentId,this._keychain,(e=>{this._log.info("Document state read: success"),this._documentStateSubj.next(e)}),(e=>{this._log.error("Storage read error:",e),this._handleStorageError(e,h)}),((e,t)=>{t?(this._log.error("Storage write error:",t),this._handleStorageError(t,h)):this._log.info("Storage write status",e)})),this._log.info("HWR Storage initialized"),this._setupEventHandlers()}_logIntegrationTestsEvent(e){var t;null===(t=this._integrationTestsEventsLogger)||void 0===t||t.call(this,{...e,timestamp:Date.now()})}_handleStorageError(e,t){e instanceof H?this._documentStateSubj.next(Q.empty(this._documentId)):e instanceof j?(this._documentStateSubj.next(Q.empty(this._documentId)),this._errors.next({kind:"databaseCorrupted"}),t.error("storageError",`Database corrupted: ${e.name}, '${e.message}'`)):e instanceof W?(this._errors.next({kind:"serverError",errorMessage:e.message}),t.error("storageError",`Server error: ${e.name}, '${e.message}'`)):e instanceof Z?(this._errors.next({kind:"unrecoverableError",errorMessage:e.message}),t.error("storageError",`Unrecoverable error: ${e.name}, '${e.message}'`)):(this._errors.next({kind:"unrecoverableError",errorMessage:e.message}),t.error("storageError",`Unknown error: ${e.name}, '${e.message}'`))}get changeTracker(){return this._changeTracker}get documentId(){return this._documentId}_setupEventHandlers(){this._subs.add(this._replacementListener.obs.pipe(E.M(this._trackingState),c.h((([e,t])=>"active"===t))).subscribe((([e])=>{this._logIntegrationTestsEvent({kind:"replacement",data:e}),this._changeTracker.onReplacementApplied(e.source,e.replacement)}))),this._subs.add(this._alertsState.subscribe((e=>{this._logIntegrationTestsEvent({kind:"alertState",data:e}),this._changeTracker.onAlertChange(e)})));const e=this._textObserver.contentChanges.async.pipe(c.h((({changes:e})=>e.length>0)),s.b((e=>{this._logIntegrationTestsEvent({kind:"contentChanges",data:e})})),E.M(this._trackingState,this._documentRetrievalState),c.h((([e,t,n])=>"active"===t&&"ok"===n)),o.U((([e])=>e)),S.B());this._subs.add(e.pipe(I.f(this._textChangeProcessingState.pipe(T.a(e.pipe(A.g(0))),c.h((([e])=>"idle"===e)))),c.h((e=>e.length>0)),s.b((e=>{this._log.debug("buffer emit",e.length)}))).subscribe((e=>{this._handleTextChange(e)}))),this._subs.add(this._selectionSource.data.changes.pipe(s.b((e=>{this._logIntegrationTestsEvent({kind:"selectionChange",data:e})})),E.M(this._trackingState),c.h((([e,t])=>"active"===t))).subscribe((([e])=>{this._changeTracker.onSelectionChange(e)}))),this._subs.add(this._writeToStorageRequestSubj.pipe(E.M(this._documentRetrievalState),c.h((([e,t])=>"ok"===t)),B.b(1e3)).subscribe((()=>this._writeToStorage()))),this._documentVisibilityObs.pipe(o.U((()=>document.hidden)),l.w((e=>L.s((()=>e),D.of(!0),D.of(!1).pipe(A.g(300)))))).subscribe((e=>{e?this._stopTrackingWhenHidden():this._resumeTrackingWhenVisible()})),this._subs.add(this._documentStateSubj.pipe(E.M(this._documentVisibilityObs.pipe(o.U((()=>document.hidden)),M.O(document.hidden)),this._trackingState)).subscribe((([e,t,n])=>{t||"active"!==n||this._handleDocumentStateChange(e)}))),this._subs.add(this._CSState.view("copiedTextMessage").pipe(s.b((e=>{this._logIntegrationTestsEvent({kind:"copiedTextMessage",data:e})}))).subscribe())}_setupKeyboardEventsHandling(){const e=(0,v.OB)().config.systemInfo.os.isMac;this._subs.add(this._keyboardEventsSource.pipe(s.b((e=>{this._logIntegrationTestsEvent({kind:"keyboardEvent",data:e})})),c.h((t=>t.isTrusted&&(1===t.key.length||"Enter"===t.key||"Tab"===t.key||"Backspace"===t.key||"Delete"===t.key)&&!t.ctrlKey&&(e?!t.metaKey:!t.altKey))),E.M(this._trackingState,this._documentRetrievalState),c.h((([e,t,n])=>"active"===t&&"ok"===n))).subscribe((([e])=>{this._trustedEvents.modify((t=>{return t.concat({timestamp:Date.now(),key:(n=e,"Enter"===n.key?"\n":"Tab"===n.key?"\t":"Backspace"===n.key||"Delete"===n.key?"":n.key)});var n}))})))}_startTracking(){this._hwrStorage.reload(),this._changeTracker.addCopiedTextToExternalStore(this._CSState.view("copiedTextMessage").get())}startTracking(){this._trackingState.set("active"),this._startTracking()}stopTracking(){this._log.info("Stopping document tracking"),this._trackingState.set("paused")}getReportableDocument(){return this._documentRetrievalState.pipe(c.h((e=>"ok"===e)),d.q(1),R.V(2e3),o.U((()=>this._changeTracker.getReportableDocument()))).toPromise()}_stopTrackingWhenHidden(){this._log.info("Pausing document tracking while document is not visible"),this._trackingState.modify((e=>"active"===e?"dormant":e))}_resumeTrackingWhenVisible(){this._log.info("Resuming document tracking after document became visible"),this._documentRetrievalState.set("waiting"),this._trackingState.modify((e=>"paused"===e?e:"active")),"active"===this._trackingState.get()&&this._startTracking()}async _handleDocumentStateChange(e){this._log.info("Got saved or Empty document.",e),await this._changeTracker.updateKnownDocumentState(e,this._textObserver.getCurrentTextMap().getPlainText()),this._documentRetrievalState.set("ok"),this._writeToStorage()}_writeToStorage(){try{this._hwrStorage.writeDocumentState(this._changeTracker.getDocumentState())}catch(e){this._log.error("Error writing to storage:",e),this._handleStorageError(e,(0,b.Tb)().humanWritingReport)}}async _handleTextChange(e){this._textChangeProcessingState.set("processing");const t=this._CSState.view("copiedTextMessage").get();this._changeTracker.addCopiedTextToExternalStore(t);for(const t of e){const e=me.QY.singleDelta(t.prevText,t.newText);if(this._log.debug("text change",e),e.ops.length>0){const t=await this._changeTracker.onTextChange(e);this._trustedEvents.modify((e=>{var n,r,a;return 0!==t||"\t"!==(null===(n=e[0])||void 0===n?void 0:n.key)&&"\n"!==(null===(r=e[0])||void 0===r?void 0:r.key)&&" "!==(null===(a=e[0])||void 0===a?void 0:a.key)?e.length-t>15?(this._log.debug("too many unmatched events, clearing them up"),(0,b.Tb)().humanWritingReport.error("changeTracking","Too many trusted events left unmatched",void 0,{count:e.length,max:15}),[]):(this._log.debug("cleaned up trusted events",{before:e,after:e.slice(t),matched:t}),e.slice(t)):(this._log.debug("got potential autocomplete/autocorrect",{before:e,after:e.slice(1),matched:t}),e.slice(1))}))}}this._textChangeProcessingState.set("idle"),this._writeToStorageRequestSubj.next()}dispose(){this._subs.unsubscribe(),this._writeToStorage()}}var Ae=n(49231),Be=n(80223),Le=n(6662),De=n(65802),Me=n(52811),Re=n(17888),Ne=n(45689),Pe=n(92310),Fe=n(89159),Ge=n(90049),Ue=n(55362),Oe=n(16711);const He={offsetLeft:"20px",offsetBottom:"20px"},je=()=>D.of(He),We=()=>{const e=document.querySelector(".left-sidebar-container-content .navigation-widget"),t=document.querySelector(Ue.Qy),n=document.querySelector(Ue.os);return e&&t&&n?Oe.x.create(e,{attributes:!0,subtree:!1,childList:!1}).pipe(c.h((e=>e.some((e=>"style"===e.attributeName)))),o.U((t=>/opacity: 0/.test(e.getAttribute("style")||""))),M.O(/opacity: 0/.test(e.getAttribute("style")||"")),l.w((e=>e?D.of(He):Ge.T(Oe.x.create(t,{attributes:!0,subtree:!1,childList:!1}).pipe(c.h((e=>e.some((e=>"style"===e.attributeName))))),x.R(self,"resize")).pipe(o.U((()=>n.getBoundingClientRect().x)),M.O(n.getBoundingClientRect().x),o.U((e=>({offsetLeft:`${e+20}px`,offsetBottom:"20px"}))))))):D.of(He)};var Ze=n(43818),ze=n(72600),$e=n(78474),Ve=n(59386),Ke=n(77530),Ye=n(59236),qe=n(94207),Qe=n(59330),Je=n(81279),Xe=n(58618);const et={width:ze.ux.rem(5.1875),height:ze.ux.rem(5.1875/4.61)},tt={$nest:{"& .gds-modal-content":{minWidth:"438px"},"& .gds-modal-medium":{width:"438px"},"& .gds-modal-header":{display:"none"},"& .gds-modal-body":{padding:ze.ux.rem($e.x0)},"& .gds-heading-large":{fontSize:ze.ux.rem(2.25),lineHeight:"1.11em"}}},nt=ze.ux.stylesheet({logo:[et],modal:[tt]}),rt=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ve.u_,{isOpen:!0,onClose:e({kind:"clipboardRequestResult",result:"close"}),title:"",dismissOnOutsideClick:!1,width:"small",role:"alertdialog",className:nt.modal},Ae.createElement(Ve.u_.Body,null,Ae.createElement(Xe.o,null,Ae.createElement(Ke.k,{direction:"column",gap:10},Ae.createElement(Ye.c,{className:nt.logo}),Ae.createElement(Ke.k,{direction:"column",gap:3},Ae.createElement(qe.X,{as:"h1",variant:"heading-large"},"Allow clipboard",Ae.createElement("br",null),"access to track",Ae.createElement("br",null),"writing accurately"),Ae.createElement(Qe.x,{as:"p"},"We need access to your clipboard so we can record the sources you use. We’ll use it to identify text you copy and paste from websites plus links to those sites.")),Ae.createElement(Ke.k,{direction:"row",gap:3},Ae.createElement(Je.z,{text:"Allow access",variant:"primary",onClick:e({kind:"clipboardRequestResult",result:"allow"})}),Ae.createElement(Je.z,{text:"Deny",variant:"ghost",onClick:e({kind:"clipboardRequestResult",result:"deny"})}))))))));var at=n(70092);const it=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ve.u_,{isOpen:!0,onClose:e({kind:"feedbackPopupClose"}),title:"",dismissOnOutsideClick:!1,width:"small",role:"alertdialog"},Ae.createElement(Ve.u_.Body,null,Ae.createElement(at.b,{onClose:e({kind:"feedbackPopupClose"}),align:"left",onSubmit:t=>e({kind:"feedbackSubmit",feedback:t.text})(),withScore:!1,fixSubmitButtonOverflowBottomPadding:!0,hideLogo:!0,title:"How can we improve?"})))));var ot=n(57259),st=n(99512),ct=n(94161),lt=n(17688),dt=n(99627),ut=n(43439);var ht=n(27645);const mt=[{id:"transparency",title:Ae.createElement(Ke.k,{align:"center",gap:2},Ae.createElement((()=>Ae.createElement("svg",{width:"23",height:"32",viewBox:"0 0 23 32",fill:"none"},Ae.createElement("path",{d:"M3.58829 4.35H15.2974C17.0724 4.35 18.5357 5.85744 18.5357 7.75342V23.8537C18.5357 25.7497 17.0724 27.2571 15.2974 27.2571H3.58829C1.81326 27.2571 0.35 25.7497 0.35 23.8537V7.75342C0.35 5.85744 1.81326 4.35 3.58829 4.35Z",fill:"white",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M4 8.5H11.89",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M4 17.5H14.89",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M4 13H14.89",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M13.704 24.3143C17.1757 24.3143 19.9901 21.4731 19.9901 17.9684C19.9901 14.4637 17.1757 11.6226 13.704 11.6226C10.2323 11.6226 7.41797 14.4637 7.41797 17.9684C7.41797 21.4731 10.2323 24.3143 13.704 24.3143Z",fill:"#B3F8F8",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M8 19.4951C8 19.4951 8.17677 19.4951 9.69062 19.4951",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M12 19.4951C12 19.4951 12.4182 19.4951 16 19.4951",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M8 15.5645H10.9419",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M13.5 15.5645H16",stroke:"#1C1C1C",strokeWidth:"0.7",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),Ae.createElement("path",{d:"M21.9414 26.6366C22.0781 26.7733 22.2997 26.7733 22.4364 26.6366C22.5731 26.4999 22.5731 26.2783 22.4364 26.1416L21.9414 26.6366ZM18.0523 22.7475L21.9414 26.6366L22.4364 26.1416L18.5473 22.2525L18.0523 22.7475Z",fill:"#1C1C1C"}))),null),Ae.createElement(Qe.x,{variant:"text-small",as:"p",weight:"normal"},"We’re transparent about data")),Content:({learnMoreURL:e})=>Ae.createElement(Ke.k,{direction:"column",gap:2},Ae.createElement(Qe.x,{variant:"text-xsmall",as:"p"},"Grammarly Authorship records your writing activity when you turn it on in a document. The data it gathers includes: text you type and delete, text you paste from other websites and links to those sites, and prompts you send to generative AI tools."),Ae.createElement(ot.r,{href:e,variant:"primary",weight:"bold",target:"_blank",underline:"hover"},Ae.createElement(Qe.x,{variant:"text-xsmall",as:"span"},"Learn more"," ",Ae.createElement(ct.J,{icon:lt.n,accessibilityLabel:"",variant:"inherit",className:ht.linkIcon}))))},{id:"safety",title:Ae.createElement(Ke.k,{align:"center",gap:2},Ae.createElement((()=>Ae.createElement("svg",{width:"21",height:"32",viewBox:"0 0 21 32",fill:"none"},Ae.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.09141 3C6.66135 3 4.69141 4.96994 4.69141 7.4V13.0256C4.69141 15.4557 6.66136 17.4256 9.09141 17.4256H11.947C14.3771 17.4256 16.347 15.4557 16.347 13.0256V7.4C16.347 4.96995 14.3771 3 11.947 3H9.09141ZM9.98539 5.49507C8.57706 5.49507 7.43539 6.63675 7.43539 8.04507V11.8101C7.43539 13.2184 8.57706 14.3601 9.98538 14.3601H11.0786C12.4869 14.3601 13.6286 13.2184 13.6286 11.8101V8.04507C13.6286 6.63675 12.4869 5.49507 11.0786 5.49507H9.98539Z",fill:"white"}),Ae.createElement("path",{d:"M5.04141 7.4C5.04141 5.16324 6.85465 3.35 9.09141 3.35V2.65C6.46805 2.65 4.34141 4.77664 4.34141 7.4H5.04141ZM5.04141 13.0256V7.4H4.34141V13.0256H5.04141ZM9.09141 17.0756C6.85466 17.0756 5.04141 15.2624 5.04141 13.0256H4.34141C4.34141 15.649 6.46806 17.7756 9.09141 17.7756V17.0756ZM11.947 17.0756H9.09141V17.7756H11.947V17.0756ZM15.997 13.0256C15.997 15.2624 14.1838 17.0756 11.947 17.0756V17.7756C14.5704 17.7756 16.697 15.649 16.697 13.0256H15.997ZM15.997 7.4V13.0256H16.697V7.4H15.997ZM11.947 3.35C14.1838 3.35 15.997 5.16325 15.997 7.4H16.697C16.697 4.77665 14.5704 2.65 11.947 2.65V3.35ZM9.09141 3.35H11.947V2.65H9.09141V3.35ZM7.78539 8.04507C7.78539 6.83005 8.77036 5.84507 9.98539 5.84507V5.14507C8.38376 5.14507 7.08539 6.44345 7.08539 8.04507H7.78539ZM7.78539 11.8101V8.04507H7.08539V11.8101H7.78539ZM9.98538 14.0101C8.77036 14.0101 7.78539 13.0251 7.78539 11.8101H7.08539C7.08539 13.4117 8.38376 14.7101 9.98538 14.7101V14.0101ZM11.0786 14.0101H9.98538V14.7101H11.0786V14.0101ZM13.2786 11.8101C13.2786 13.0251 12.2936 14.0101 11.0786 14.0101V14.7101C12.6802 14.7101 13.9786 13.4117 13.9786 11.8101H13.2786ZM13.2786 8.04507V11.8101H13.9786V8.04507H13.2786ZM11.0786 5.84507C12.2936 5.84507 13.2786 6.83004 13.2786 8.04507H13.9786C13.9786 6.44345 12.6802 5.14507 11.0786 5.14507V5.84507ZM9.98539 5.84507H11.0786V5.14507H9.98539V5.84507Z",fill:"#1C1C1C"}),Ae.createElement("rect",{x:"0.35",y:"10.5629",width:"20.3",height:"17.5082",rx:"2.41596",fill:"#B3F8F8",stroke:"#1C1C1C",strokeWidth:"0.7",strokeLinecap:"round"}),Ae.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.4866 20.0964C12.2255 19.7611 12.7339 19.0611 12.7339 18.2517C12.7339 17.1165 11.7338 16.1963 10.5002 16.1963C9.26654 16.1963 8.26648 17.1165 8.26648 18.2517C8.26648 19.061 8.77474 19.7611 9.51355 20.0963V22.3355C9.51355 22.8803 9.95524 23.322 10.5001 23.322C11.045 23.322 11.4866 22.8803 11.4866 22.3355V20.0964Z",fill:"white"}),Ae.createElement("path",{d:"M11.4866 20.0964L11.342 19.7776L11.1366 19.8708V20.0964H11.4866ZM9.51355 20.0963H9.86355V19.8708L9.65818 19.7776L9.51355 20.0963ZM12.3839 18.2517C12.3839 18.9067 11.9722 19.4918 11.342 19.7776L11.6313 20.4151C12.4789 20.0305 13.0839 19.2154 13.0839 18.2517H12.3839ZM10.5002 16.5463C11.5685 16.5463 12.3839 17.3367 12.3839 18.2517H13.0839C13.0839 16.8964 11.8991 15.8463 10.5002 15.8463V16.5463ZM8.61648 18.2517C8.61648 17.3367 9.43186 16.5463 10.5002 16.5463V15.8463C9.10121 15.8463 7.91648 16.8964 7.91648 18.2517H8.61648ZM9.65818 19.7776C9.02814 19.4917 8.61648 18.9066 8.61648 18.2517H7.91648C7.91648 19.2154 8.52134 20.0304 9.36892 20.415L9.65818 19.7776ZM9.86355 22.3355V20.0963H9.16355V22.3355H9.86355ZM10.5001 22.972C10.1485 22.972 9.86355 22.687 9.86355 22.3355H9.16355C9.16355 23.0736 9.76194 23.672 10.5001 23.672V22.972ZM11.1366 22.3355C11.1366 22.687 10.8517 22.972 10.5001 22.972V23.672C11.2383 23.672 11.8366 23.0736 11.8366 22.3355H11.1366ZM11.1366 20.0964V22.3355H11.8366V20.0964H11.1366Z",fill:"#1C1C1C"}))),null),Ae.createElement(Qe.x,{variant:"text-small",as:"p",weight:"normal"},"We’ll keep your data safe")),Content:({learnMoreURL:e})=>Ae.createElement(Ke.k,{direction:"column",gap:2},Ae.createElement(Qe.x,{variant:"text-xsmall",as:"p"},"When you start Authorship, its data is stored on your device in an encrypted format. When you see or share your report, this data is sent to Grammarly over an encrypted connection."),Ae.createElement(ot.r,{href:e,variant:"primary",weight:"bold",target:"_blank",underline:"hover"},Ae.createElement(Qe.x,{variant:"text-xsmall",as:"span"},"Learn more"," ",Ae.createElement(ct.J,{icon:lt.n,accessibilityLabel:"",variant:"inherit",className:ht.linkIcon}))))},{id:"control",title:Ae.createElement(Ke.k,{align:"center",gap:2},Ae.createElement((()=>Ae.createElement("svg",{width:"22",height:"32",viewBox:"0 0 22 32",fill:"none"},Ae.createElement("rect",{x:"0.375",y:"6.375",width:"21.25",height:"7.25",rx:"3.625",fill:"#B3F8F8",stroke:"#1C1C1C",strokeWidth:"0.75"}),Ae.createElement("circle",{cx:"18",cy:"10",r:"3.625",fill:"white",stroke:"#1C1C1C",strokeWidth:"0.75"}),Ae.createElement("rect",{x:"-0.375",y:"0.375",width:"21.25",height:"7.25",rx:"3.625",transform:"matrix(-1 0 0 1 21.25 18)",fill:"white",stroke:"#1C1C1C",strokeWidth:"0.75"}),Ae.createElement("circle",{cx:"4",cy:"4",r:"3.625",transform:"matrix(-1 0 0 1 8 18)",fill:"white",stroke:"#1C1C1C",strokeWidth:"0.75"}))),null),Ae.createElement(Qe.x,{variant:"text-small",as:"p",weight:"normal"},"You’re always in control")),Content:({learnMoreURL:e})=>Ae.createElement(Ke.k,{direction:"column",gap:2},Ae.createElement(Qe.x,{variant:"text-xsmall",as:"p"},"You choose when Authorship tracks your writing activity and when you share your report. You can stop sharing your report or delete your writing activity data anytime."),Ae.createElement(ot.r,{href:e,variant:"primary",weight:"bold",target:"_blank",underline:"hover"},Ae.createElement(Qe.x,{variant:"text-xsmall",as:"span"},"Learn more"," ",Ae.createElement(ct.J,{icon:lt.n,accessibilityLabel:"",variant:"inherit",className:ht.linkIcon}))))}],pt={width:ze.ux.rem(5.1875),height:ze.ux.rem(5.1875/4.61)},gt={$nest:{"& .gds-modal-content":{minWidth:"860px"},"& .gds-modal-medium":{width:"860px"},"& .gds-modal-header":{display:"none"},"& .gds-modal-body":{padding:ze.ux.rem($e.x0)},"& .gds-heading-large":{fontSize:ze.ux.rem(2.25),lineHeight:"1.11em"}}},ft=ze.ux.stylesheet({logo:[pt],link:[{whiteSpace:"normal"}],linkIcon:[{verticalAlign:"top"}],flip:[{transform:"rotate(180deg)"}],modal:[gt]}),kt=(0,dt.xb)(ot.r),bt=(0,dt.xb)((({learnMoreURLs:e})=>{const[t,n]=Ae.useState([]);return Ae.createElement("div",{className:ht.accordionRoot},Ae.createElement("div",null,mt.map((({id:r,title:a,Content:i})=>{const o=t.includes(r),s=`optInAccordion-title-${r}`,c=`optInAccordion-content-${r}`;return Ae.createElement("div",{key:r,className:`${ht.accordionItem}`},Ae.createElement("button",{id:s,className:ht.accordionHeader,onClick:()=>{n(o?[]:[r])},"aria-controls":c,"aria-expanded":o},Ae.createElement("div",{className:ht.accordionTrigger},a,Ae.createElement(Ke.k,{className:`${ht.accordionIcon} ${o?ht.rotate:""}`},Ae.createElement(ct.J,{size:"large",icon:ut.p,accessibilityLabel:o?"Collapse section":"Expand section"})))),Ae.createElement("div",{role:"region","aria-labelledby":s,className:`${ht.accordionContent} ${o?ht.shown:""}`},Ae.createElement(i,{learnMoreURL:e[r]})))}))))})),vt=Ne.UI.Node.make((({view:e,state:t,notify:n})=>Ae.createElement(Ve.u_,{isOpen:!0,onClose:n({kind:"closeOptInPopup"}),title:"",dismissOnOutsideClick:!1,width:"medium",role:"alertdialog",className:ft.modal},Ae.createElement(Ve.u_.Body,null,Ae.createElement(Xe.o,null,Ae.createElement(Ke.k,{direction:"row",gap:6},Ae.createElement(Ke.k,{direction:"column",gap:10,flex:"1 1 50%"},Ae.createElement(Ye.c,{className:ft.logo}),Ae.createElement(Ke.k,{direction:"column",gap:3},Ae.createElement(st.V,{variant:"addition",label:"Beta"}),Ae.createElement(qe.X,{as:"h1",variant:"heading-large"},"Prove where your",Ae.createElement("br",null),"words come from"),Ae.createElement(Qe.x,{as:"p"},"With Grammarly Authorship, you can certify what you type, copy, or generate with AI. You choose how to share this information."),Ae.createElement(kt,{href:e("howItWorksURL"),variant:"primary",weight:"bold",target:"_blank",underline:"hover"},"See how it works"," ",Ae.createElement(ct.J,{icon:lt.n,accessibilityLabel:"",variant:"inherit",className:ft.linkIcon}))),Ae.createElement(Je.z,{text:"OK",onClick:n({kind:"optIn"})})),Ae.createElement(Ke.k,{direction:"column",gap:3,flex:"1 1 50%",align:"stretch"},Ae.createElement(Ke.k,{direction:"row",flex:"1 0 0%",align:"center"},Ae.createElement(bt,{learnMoreURLs:t.pipe(o.U((({learnMoreTransparencyURL:e,learnMoreSafetyURL:t,learnMoreControlURL:n})=>({transparency:e,safety:t,control:n}))))})),Ae.createElement(Qe.x,{as:"p",color:"base-subdued",variant:"text-xsmall"},"By tracking writing activity, the Beta terms in your agreement with Grammarly (",Ae.createElement(ot.r,{href:"https://www.grammarly.com/terms/customer-business-agreement",variant:"secondary",className:ft.link},"Customer Business Agreement"),", ",Ae.createElement(ot.r,{href:"https://www.grammarly.com/terms",variant:"secondary",className:ft.link},"Terms and Conditions")," ","and our"," ",Ae.createElement(ot.r,{href:"https://www.grammarly.com/privacy-policy",variant:"secondary",className:ft.link},"Privacy Policy"),", as applicable) will apply.")))))))),_t=Ne.UI.Union.make("kind",{optIn:vt,clipboardAccess:rt,feedback:it}),yt=Ne.UI.Union.asOption(_t);var Ct=n(11250);const wt=ze.ux.stylesheet({toast:[{$nest:{"&&":{minWidth:"376px"}}}]}),xt=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ct.F,{variant:"success",text:"Grammarly is tracking your writing activity in this document. Click the icon to stop tracking or see your report.",onClose:e({kind:"dismissToast"}),onMouseEnter:e({kind:"toastHover",hovered:!0}),onMouseLeave:e({kind:"toastHover",hovered:!1}),className:wt.toast}))),St=(0,dt.xb)(Ct.F),Et=Ne.UI.Node.make((({state:e,notify:t})=>Ae.createElement(St,{variant:"success",text:e.pipe(o.U((({domain:e,wasNewDocument:t})=>`Authorship ${t?"is tracking your writing activity in this doc. It will start tracking":"will start tracking your writing activity"} anytime you create a new ${"docs.google.com"===e?"Google doc":`doc on ${e}`}.`))),onClose:t({kind:"dismissToast"}),onMouseEnter:t({kind:"toastHover",hovered:!0}),onMouseLeave:t({kind:"toastHover",hovered:!1}),className:wt.toast}))),It=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ct.F,{variant:"success",text:"Grammarly Authorship is turned off. If you want the option to track your writing activity, you can turn it on in Settings.",primaryAction:Ae.createElement(Je.z,{text:"OK",variant:"primary",onClick:e({kind:"optOutToastOkClick"})}),onClose:e({kind:"dismissToast"}),onMouseEnter:e({kind:"toastHover",hovered:!0}),onMouseLeave:e({kind:"toastHover",hovered:!1}),className:wt.toast}))),Tt=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ct.F,{variant:"success",text:"Grammarly Authorship is now available. Start it to track your writing activity in a doc.",onClose:e({kind:"dismissToast"}),onMouseEnter:e({kind:"toastHover",hovered:!0}),onMouseLeave:e({kind:"toastHover",hovered:!1}),className:wt.toast}))),At=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ct.F,{variant:"critical",text:"Could not generate Authorship Report. Please try again later.",onClose:e({kind:"dismissToast"}),onMouseEnter:e({kind:"toastHover",hovered:!0}),onMouseLeave:e({kind:"toastHover",hovered:!1}),className:wt.toast}))),Bt=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ct.F,{variant:"critical",text:"An error occurred while saving your editing history data.",onClose:e({kind:"dismissToast"}),onMouseEnter:e({kind:"toastHover",hovered:!0}),onMouseLeave:e({kind:"toastHover",hovered:!1}),className:wt.toast}))),Lt=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ct.F,{variant:"critical",text:"Could not retrieve editing history data. Tracking will start from scratch.",onClose:e({kind:"dismissToast"}),onMouseEnter:e({kind:"toastHover",hovered:!0}),onMouseLeave:e({kind:"toastHover",hovered:!1}),className:wt.toast}))),Dt=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ct.F,{variant:"critical",text:"An error occurred while communicating with the server. Please try again later.",onClose:e({kind:"dismissToast"}),onMouseEnter:e({kind:"toastHover",hovered:!0}),onMouseLeave:e({kind:"toastHover",hovered:!1}),className:wt.toast}))),Mt=Ne.UI.Node.make((({notify:e})=>Ae.createElement(Ct.F,{variant:"warning",text:"Without clipboard access, Authorship will mark any text you paste as “Copied from unknown source.” To accurately record your sources, allow clipboard access.",primaryAction:Ae.createElement(Je.z,{text:"Allow clipboard access",variant:"primary",onClick:e({kind:"clipboardWarningResult",result:"allow"})}),secondaryAction:Ae.createElement(Je.z,{text:"Deny",variant:"ghost",onClick:e({kind:"clipboardWarningResult",result:"deny"})}),onClose:e({kind:"clipboardWarningResult",result:"close"}),onMouseEnter:e({kind:"toastHover",hovered:!0}),onMouseLeave:e({kind:"toastHover",hovered:!1}),className:wt.toast}))),Rt=Ne.UI.Union.make("kind",{documentTrackingStarted:xt,domainTrackingStarted:Et,domainTrackingStartedWhenAlreadyTracked:Et,optedOut:It,optedIn:Tt,reportGenerationFailed:At,clipboardWarning:Mt,storageUnrecoverableError:Bt,storageDatabaseCorrupted:Lt,storageServerError:Dt}),Nt=Ne.UI.Union.asOption(Rt);var Pt=n(75694);const Ft=ze.ux.keyframes({"0%":{transform:"scale(1)",opacity:.5},"75%":{transform:"scale(6)",opacity:0},"100%":{transform:"scale(6)",opacity:0}}),Gt={width:ze.ux.rem(.5),height:ze.ux.rem(.5),borderRadius:ze.ux.rem(.25),position:"relative",backgroundColor:Pt.I.Background.Brand.Default,overflow:"visible",$nest:{"&:before":{content:"' '",width:"100%",height:"100%",borderRadius:"50%",position:"absolute",backgroundColor:Pt.I.Background.Brand.Default,top:0,left:0,transformOrigin:"50% 50%",animationName:Ft,animationDuration:"1.5s",animationIterationCount:"infinite",animationDirection:"normal",animationFillMode:"backwards"}}},Ut=ze.ux.stylesheet({dot:[Gt]}),Ot=()=>Ae.createElement("div",{className:Ut.dot}),Ht=()=>Ae.createElement("svg",{fill:"none",fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",viewBox:"0 0 20 20"},Ae.createElement("path",{d:"M14 20a6 6 0 1 0 0-12 6 6 0 0 0 0 12Zm0-1a5 5 0 1 0-.001-10.001A5 5 0 0 0 14 19Zm-2-7.7c0-.08.03-.156.084-.212a.279.279 0 0 1 .202-.088h.571c.076 0 .149.032.202.088a.305.305 0 0 1 .084.212v5.4c0 .08-.03.156-.084.212a.279.279 0 0 1-.202.088h-.571a.279.279 0 0 1-.202-.088A.305.305 0 0 1 12 16.7v-5.4Zm2.857 0c0-.08.03-.156.084-.212a.279.279 0 0 1 .202-.088h.571c.076 0 .149.032.202.088A.305.305 0 0 1 16 11.3v5.4c0 .08-.03.156-.084.212a.279.279 0 0 1-.202.088h-.571a.279.279 0 0 1-.202-.088.305.305 0 0 1-.084-.212v-5.4Z",fill:"inherit"}),Ae.createElement("path",{d:"M6.964 14.924a6.912 6.912 0 0 1-.726-.148v-1.963a.425.425 0 1 0-.85-.001v1.683a7.013 7.013 0 0 1-2.651-1.881V8a5.264 5.264 0 0 1 10.426-1.025 6.987 6.987 0 0 0-.886.161A4.364 4.364 0 0 0 3.638 8v3.5a.425.425 0 1 0 .85 0V8a3.512 3.512 0 0 1 6.972-.608 7.066 7.066 0 0 0-.856.395A2.612 2.612 0 0 0 5.388 8v2.625a.425.425 0 1 0 .85 0V8a1.762 1.762 0 0 1 3.524 0v.325a7.057 7.057 0 0 0-2.798 6.599Zm7.054-7.998A6.113 6.113 0 0 0 1.888 8v3.412A7.004 7.004 0 0 1 8 1a7.005 7.005 0 0 1 6.927 5.986 7.166 7.166 0 0 0-.909-.06ZM7.575 8v.75a.425.425 0 1 0 .85 0V8a.425.425 0 1 0-.85 0Z",fill:"#027e6f"})),jt=()=>Ae.createElement("svg",{viewBox:"0 0 20 20",fill:"none",fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2"},Ae.createElement("path",{d:"M4 15.289V10a6 6 0 1 1 12 0v5.289a7.98 7.98 0 0 1-1 .954V13a.5.5 0 0 0-1 0v3.928c-.32.186-.654.349-1 .49V10a3 3 0 1 0-6 0v3a.5.5 0 0 0 1 0v-3a2 2 0 1 1 4 0v7.748a8.062 8.062 0 0 1-1.5.237V13.5a.5.5 0 0 0-1 0v4.485a8.062 8.062 0 0 1-1.5-.237V15.5a.5.5 0 0 0-1 0v1.918a8.022 8.022 0 0 1-3-2.129Zm10.474-4.29L14.5 11l.021-.003c.096-.016.479-.105.479-.508V10a5 5 0 0 0-10 0v4.5a.5.5 0 0 0 1 0V10a4 4 0 0 1 8 0l.5.5-.5-.5v.5a.5.5 0 0 0 .474.499ZM3 13.873A7.954 7.954 0 0 1 2 10c0-4.415 3.585-8 8-8a8.004 8.004 0 0 1 7 11.874V10a7 7 0 1 0-14 0v3.873ZM9.5 10v1a.5.5 0 0 0 1 0v-1a.5.5 0 0 0-1 0Z",fill:"inherit"})),Wt={$nest:{svg:{width:ze.ux.rem(1.25),height:ze.ux.rem(1.25),fill:Pt.I.Icon.Brand.Default}}},Zt={position:"absolute",right:ze.ux.rem(-.25),top:ze.ux.rem(-.25)},zt=ze.ux.stylesheet({icon:[Wt],button:[{background:"none",border:"none",cursor:"pointer",position:"relative"}],attractSequnce:[Zt]}),$t=Ne.UI.Node.make((({view:e,notify:t,state:n})=>Ae.createElement(Ae.Fragment,null,Ae.createElement(Ze.F.button,{className:zt.button,"aria-label":e("trackingState").pipe(o.U((e=>"tracking"===e?"Press to pause authorship tracking":"Press to start authorship tracking"))),onClick:t({kind:"trackingButtonClick"})},Ae.createElement(Ze.F.div,{className:zt.icon},e("trackingState").pipe(o.U((e=>"tracking"===e?Ae.createElement(Ht,null):Ae.createElement(jt,null)))),n.pipe(o.U((({optInPopupWasClosedOnce:e,trackingState:t})=>!e&&"available"===t&&Ae.createElement("div",{className:zt.attractSequnce},Ae.createElement(Ot,null))))))))));var Vt=n(16935),Kt=n(11552),Yt=n(3745),qt=n(27765),Qt=n(2274),Jt=n(76896),Xt=n(83387),en=n(43784);const tn=()=>Ae.createElement("svg",{fill:"none",fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",viewBox:"0 0 20 20"},Ae.createElement("path",{d:"M13.257,10.429C13.408,10.338 13.5,10.176 13.5,10C13.5,9.824 13.408,9.662 13.257,9.571L8.257,6.571C8.103,6.479 7.91,6.476 7.754,6.565C7.597,6.654 7.5,6.82 7.5,7L7.5,13C7.5,13.18 7.597,13.346 7.754,13.435C7.91,13.524 8.103,13.521 8.257,13.429L13.257,10.429ZM12.028,10L8.5,12.117C8.5,12.117 8.5,7.883 8.5,7.883L12.028,10Z",fill:"inherit"}),Ae.createElement("path",{d:"M9.8,2.183C5.437,2.183 1.9,5.72 1.9,10.083C1.9,14.446 5.437,17.983 9.8,17.983C14.162,17.983 17.7,14.446 17.7,10.083C17.7,5.72 14.162,2.183 9.8,2.183ZM9.8,3.183C13.61,3.183 16.7,6.272 16.7,10.083C16.7,13.894 13.61,16.983 9.8,16.983C5.989,16.983 2.9,13.894 2.9,10.083C2.9,6.272 5.989,3.183 9.8,3.183Z",fill:"inherit"})),nn=()=>Ae.createElement("svg",{fill:"none",fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",viewBox:"0 0 20 20"},Ae.createElement("path",{id:"Vector",d:"M7.714,6.914C7.714,6.823 7.749,6.736 7.81,6.672C7.871,6.608 7.954,6.571 8.041,6.571L8.694,6.571C8.781,6.571 8.864,6.608 8.925,6.672C8.986,6.736 9.02,6.823 9.02,6.914L9.02,13.086C9.02,13.177 8.986,13.264 8.925,13.328C8.864,13.392 8.781,13.429 8.694,13.429L8.041,13.429C7.954,13.429 7.871,13.392 7.81,13.328C7.749,13.264 7.714,13.177 7.714,13.086L7.714,6.914ZM10.98,6.914C10.98,6.823 11.014,6.736 11.075,6.672C11.137,6.608 11.22,6.571 11.306,6.571L11.959,6.571C12.046,6.571 12.129,6.608 12.19,6.672C12.251,6.736 12.286,6.823 12.286,6.914L12.286,13.086C12.286,13.177 12.251,13.264 12.19,13.328C12.129,13.392 12.046,13.429 11.959,13.429L11.306,13.429C11.22,13.429 11.137,13.392 11.075,13.328C11.014,13.264 10.98,13.177 10.98,13.086L10.98,6.914Z",fill:"inherit"}),Ae.createElement("path",{id:"Subtract",d:"M10,16.857C13.787,16.857 16.857,13.787 16.857,10C16.857,6.213 13.787,3.143 10,3.143C6.213,3.143 3.143,6.213 3.143,10C3.143,13.787 6.213,16.857 10,16.857ZM10,15.714C13.156,15.714 15.714,13.156 15.714,10C15.714,6.844 13.156,4.286 10,4.286C6.844,4.286 4.286,6.844 4.286,10C4.286,13.156 6.844,15.714 10,15.714Z",fill:"inherit"})),rn={boxShadow:Vt.H8.boxShadow,border:Vt.H8.border,background:Pt.I.Background.Base.Default,borderRadius:ze.ux.rem(.5),position:"relative",minWidth:"260px"},an={position:"absolute",bottom:"100%",right:0,marginBottom:ze.ux.rem($e.F2),background:Pt.I.Background.Base.Default,boxShadow:Vt.H8.boxShadow,border:Vt.H8.border,borderRadius:ze.ux.rem(Kt.xB),maxWidth:"200px",overflow:"hidden"},on={$nest:{svg:{width:ze.ux.rem(1.25),height:ze.ux.rem(1.25),fill:Pt.I.Icon.Base.Inverse,stroke:"none"}}},sn={$nest:{svg:{width:ze.ux.rem(1.25),height:ze.ux.rem(1.25),fill:Pt.I.Icon.Brand.Default,stroke:"none"}}},cn={borderBottom:`1px solid ${Pt.I.Border.Base.Subdued}`},ln={color:"inherit",display:"block",textDecoration:"none",padding:ze.ux.rem($e.x),$nest:{"&:hover":{background:Pt.I.Background.Base.Subdued},"&:active":{background:Pt.I.Border.Base.Subdued}}},dn={color:"inherit",display:"block",padding:ze.ux.rem($e.x),background:"none",border:"none",margin:0,textAlign:"left",cursor:"pointer",$nest:{"&:hover":{background:Pt.I.Background.Base.Subdued},"&:active":{background:Pt.I.Border.Base.Subdued}}},un=ze.ux.stylesheet({container:[rn],settingsButton:[{alignSelf:"inherit"}],logButtonContainer:[{position:"relative"}],menu:[an],logButton:[on],pauseButton:[sn],infoIcon:[{$nest:{"&&":{cursor:"default"}}}],switch:[{transform:"scale(0.86) translateY(0.5px)",transformOrigin:"center right",width:"160px",whiteSpace:"nowrap",display:"flex",flexDirection:"row-reverse",overflow:"visible"}],section:[cn],menuLink:[ln],menuButton:[dn],fullWidth:[{flex:"1 0 0%"}]}),hn=({onClick:e})=>Ae.createElement(Je.z,{className:un.logButton,onClick:e,width:"full"},Ae.createElement(Ke.k,{direction:"row",gap:2,align:"center"},Ae.createElement(jt,null),Ae.createElement(Qe.x,{as:"span",weight:"bold",variant:"text-small"},"Track writing activity"))),mn=({isPaused:e,onPauseClick:t,onResumeClick:n,onViewReportClick:r})=>Ae.createElement(Ke.k,{direction:"row",gap:2,align:"center"},Ae.createElement(Je.z,{variant:"secondary",className:un.pauseButton,onClick:e?n:t,width:"full"},Ae.createElement(Ke.k,{direction:"row",gap:2,align:"center"},e?Ae.createElement(tn,null):Ae.createElement(nn,null),Ae.createElement(Qe.x,{as:"span",weight:"bold",variant:"text-small"},e?"Resume tracking":"Stop tracking"))),Ae.createElement(Je.z,{text:"See report",onClick:r,width:"full"})),pn=Ne.UI.Node.make((({notify:e,state:t,view:n})=>{const[r,a]=Ae.useState(!1);return Ae.createElement(en.d,{onClickAway:e({kind:"trackingButtonClickAway"})},Ae.createElement(Ke.k,{direction:"column",padding:2,gap:2,className:un.container},Ae.createElement(Ke.k,{direction:"row",gap:2,align:"center"},Ae.createElement(ct.J,{icon:Yt.H,accessibilityLabel:"Grammarly",size:"small"}),Ae.createElement(Ke.k,{direction:"row",flex:"1 0 auto",gap:1},Ae.createElement(Qe.x,{as:"span",variant:"text-xsmall",color:"base-subdued"},"Grammarly Authorship"),Ae.createElement(st.V,{variant:"neutral",label:"Beta"})),Ae.createElement(Ke.k,{direction:"row"},Ae.createElement(qt.h,{accessibilityLabel:"Settings",icon:Qt.a,variant:"tertiary",onClick:()=>a(!r),size:"small","aria-controls":"hwr-settings-menu"}),Ae.createElement(qt.h,{accessibilityLabel:"Close",icon:Jt.V,variant:"tertiary",onClick:e({kind:"trackingButtonCloseClick"}),size:"small"}))),Ae.createElement(Ze.F.Fragment,null,t.pipe(o.U((({trackingState:t})=>"available"===t||"newDocument"===t?Ae.createElement(hn,{onClick:e({kind:"start"})}):Ae.createElement(mn,{isPaused:"paused"===t,onResumeClick:e({kind:"resume"}),onPauseClick:e({kind:"pause"}),onViewReportClick:e({kind:"viewReport"})}))))),r&&Ae.createElement(en.d,{onClickAway:()=>a(!1)},Ae.createElement("div",{className:un.menu,role:"menu",id:"hwr-settings-menu"},Ae.createElement(Ke.k,{direction:"column"},Ae.createElement(Ze.F.Fragment,null,t.pipe(o.U((({enabledForDomain:t,domain:n,trackingState:r})=>{const a="docs.google.com"===n?"all new Google Docs":`all new documents on ${n}`;return Ae.createElement(Ke.k,{direction:"column",gap:1,padding:2,className:un.section},Ae.createElement(Xt.r,{label:"Start automatically",size:1,defaultSelected:t,onChange:t=>e(t?{kind:"enableForDomain",isNewDocument:"newDocument"===r}:{kind:"resetForDomain"})(),"aria-describedby":"hwr-toggle-description"}),Ae.createElement(Qe.x,{as:"p",variant:"text-xsmall",color:"base-subdued",id:"hwr-toggle-description"},"Track writing activity for ",a,"."))})))),Ae.createElement(Ke.k,{direction:"column",gap:1,className:un.section},Ae.createElement(Ze.F.Fragment,null,n("urls").pipe(o.U((e=>Ae.createElement(Ae.Fragment,null,Ae.createElement("a",{href:e.howItWorks,className:un.menuLink,role:"menuitem"},Ae.createElement(Qe.x,{as:"span",variant:"text-small"},"How Authorship works?")),Ae.createElement("a",{href:e.reportAnIssue,className:un.menuLink,role:"menuitem"},Ae.createElement(Qe.x,{as:"span",variant:"text-small"},"Report an issue"))))))),Ae.createElement("button",{onClick:()=>{e({kind:"giveFeedback"})(),a(!1)},className:un.menuButton,role:"menuitem"},Ae.createElement(Qe.x,{as:"span",variant:"text-small"},"Give feedback"))),Ae.createElement("button",{onClick:e({kind:"optOut"}),className:un.menuButton,role:"menuitem"},Ae.createElement(Qe.x,{as:"span",variant:"text-small"},"Turn off Authorship")))))))})),gn=Ne.UI.Union.make("state",{compact:$t,expanded:pn}),fn=Ne.UI.Union.asOption(gn),kn=Ne.UI.Grid.make((({slots:e,view:t})=>Ae.createElement(Ze.F.div,{"data-grammarly-part":"human-writing-report-button",style:{position:"fixed",left:t("offsetLeft"),bottom:t("offsetBottom"),zIndex:1e4}},e.popup,e.trackingButton,Ae.createElement("div",{style:{position:"absolute",left:"100%",bottom:0}},e.toast)))),bn=Ne.UI.Knot.make(kn,{trackingButton:fn,popup:yt,toast:Nt}),vn=Ne.UI.Union.asOption(bn);function _n(e){return Ne.Z.fromSideEffect((t=>{e.next(t)}),D.of(null))}function yn(e){return Ne.Z.fromSideEffect((t=>{e.next(t)}),D.of(null))}function Cn(e,t){return Ne.Z.fromSideEffect((e=>{t.next({kind:e.kind})}),e.pipe(Le.oA,o.U((({urls:e})=>({howItWorksURL:e.howItWorks,learnMoreTransparencyURL:e.learnMoreTransparency,learnMoreSafetyURL:e.learnMoreSafety,learnMoreControlURL:e.learnMoreControl})))))}function wn(e,t){return Ne.Z.composeUnion({optIn:Cn(e,t),clipboardAccess:_n(t),feedback:yn(t)},(()=>e.pipe(Le.oA,De.j("popup"),Le.oA,o.U((e=>({kind:e}))))))}function xn(e,t){return Ne.Z.composeUnion({None:()=>D.of(null),Some:Ne.Z.composeKnot({value:wn(e,t)})},(()=>e.pipe(Le.oA,De.j("popup"))))}function Sn(e,t){return Ne.Z.composeUnion({documentTrackingStarted:Ne.Z.fromSideEffect((e=>{t.next({...e})}),D.of(null)),domainTrackingStarted:Ne.Z.fromSideEffect((e=>{t.next({...e})}),e.pipe(Le.oA,o.U((({domain:e})=>({domain:e,wasNewDocument:!0}))))),domainTrackingStartedWhenAlreadyTracked:Ne.Z.fromSideEffect((e=>{t.next({...e})}),e.pipe(Le.oA,o.U((({domain:e})=>({domain:e,wasNewDocument:!1}))))),optedOut:Ne.Z.fromSideEffect((e=>{t.next({...e})}),D.of(null)),optedIn:Ne.Z.fromSideEffect((e=>{t.next({...e})}),D.of(null)),reportGenerationFailed:Ne.Z.fromSideEffect((e=>{t.next({...e})}),D.of(null)),clipboardWarning:Ne.Z.fromSideEffect((e=>{t.next({...e})}),D.of(null)),storageDatabaseCorrupted:Ne.Z.fromSideEffect((e=>{t.next({...e})}),D.of(null)),storageUnrecoverableError:Ne.Z.fromSideEffect((e=>{t.next({...e})}),D.of(null)),storageServerError:Ne.Z.fromSideEffect((e=>{t.next({...e})}),D.of(null))},(()=>e.pipe(Le.oA,De.j("toast"),Le.oA,o.U((e=>({kind:e}))))))}function En(e,t){return Ne.Z.composeUnion({None:()=>D.of(null),Some:Ne.Z.composeKnot({value:Sn(e,t)})},(()=>e.pipe(Le.oA,De.j("toast"))))}function In(e,t){return Ne.Z.fromSideEffect((e=>{if("trackingButtonClick"===e.kind)t.next({kind:"trackingButtonClick"});else(0,m.L0)(e.kind)}),e.pipe(Le.oA))}function Tn(e,t){return Ne.Z.fromSideEffect((e=>{switch(e.kind){case"trackingButtonClickAway":case"trackingButtonCloseClick":case"viewReport":case"optOut":case"start":case"pause":case"resume":case"enableForDomain":case"resetForDomain":case"giveFeedback":t.next(e);break;default:(0,m.L0)(e)}}),e.pipe(Le.oA))}function An(e,t){return Ne.Z.composeUnion({compact:In(e,t),expanded:Tn(e,t)},(()=>e.pipe(Le.oA,o.U((({trackingButtonExpanded:e})=>({state:e?"expanded":"compact"}))))))}class Bn{constructor(e,t,n,r,i,o,s=je){this.actions=t,this.errors=n,this._events=r,this._documentId=i,this._gnar=o,this._createTButtonPositionSource=s,this._state=p.h.create(h.YP),this._tButtonPosition=p.h.create(He),this.state=this._state.view(),this.tButtonPosition=this._tButtonPosition.view(),this._subs=new a.w,this._domain=e.view("page").view("domain").get(),this._subs.add(this._handleCSStateChange(e).subscribe()),this._subs.add(this._handleActions().subscribe()),this._subs.add(this._handleErrors().subscribe()),this._subs.add(this._handleEvents().subscribe()),this._subs.add(this._handleEnabledForDomainOnce().subscribe()),this._subs.add(this._autocloseToast().subscribe()),this._subs.add(this._handleToastShow().subscribe()),this._subs.add(s().subscribe(Be.wW(this._tButtonPosition)))}_handleCSStateChange(e){return e.pipe(o.U((e=>{this._state.modify((t=>{var n;const a=null!==(n=e.page.humanWritingReport)&&void 0!==n?n:f.wg;return e.page.enabled&&("optedOut"===a.kind||"available"===a.kind||"enabled"===a.kind)?(0,r.zG)(t,h.UI((t=>this._reducePageStateToLocalState(e,t))),h.wp((()=>h.G(this._reducePageStateToLocalState(e))))):h.YP}))})))}_reducePageStateToLocalState({page:{domain:e,humanWritingReport:t=f.wg},dynamicConfig:n},r){var a;return{trackingState:"optedOut"===t.kind?"optedOut":"available"===t.kind?"available":(0,f.MP)(this._documentId,this._domain,t)?(0,f.Ng)(this._documentId,this._domain,t)?"tracking":"paused":"newDocument",optInPopupWasClosedOnce:"available"!==t.kind||t.optInPopUpWasClosedAtLeastOnce,trackingButtonExpanded:!!r&&r.trackingButtonExpanded,enabledForDomain:(0,f.E3)(this._domain,t),domain:e,popup:r?r.popup:h.YP,toast:r?r.toast:h.YP,urls:{...ge.ym,...null===(a=null==n?void 0:n.hwr)||void 0===a?void 0:a.urls}}}_handleEnabledForDomainOnce(){return this.actions.pipe(c.h((e=>"enableForDomain"===e.kind)),d.q(1),s.b((({isNewDocument:e})=>this._state.modify((t=>(0,r.zG)(t,h.tS((t=>{const n={...t,toast:h.G(e?"domainTrackingStarted":"domainTrackingStartedWhenAlreadyTracked")};return h.G(n)}))))))))}_handleToastShow(){return this._state.pipe(Le.oA,De.j("toast"),Le.oA,s.b((e=>{switch(e){case"documentTrackingStarted":case"domainTrackingStarted":case"domainTrackingStartedWhenAlreadyTracked":case"optedOut":case"optedIn":case"clipboardWarning":this._gnar.hwrToastShow(this._documentId,"info",e);break;case"storageDatabaseCorrupted":case"reportGenerationFailed":case"storageUnrecoverableError":case"storageServerError":this._gnar.hwrToastShow(this._documentId,"error",e)}})))}_autocloseToast(){const e=this.actions.pipe(c.h((e=>"toastHover"===e.kind)),De.j("hovered"),M.O(!1));return this._state.pipe(Le.oA,De.j("toast"),Le.oA,l.w((t=>"clipboardWarning"===t?u.E:Me.S3(e.pipe(l.w((e=>e?u.E:Re.timer(ge.bd)))),this.actions.pipe(c.h((e=>"dismissToast"===e.kind)))))),s.b((()=>{this._state.modify((e=>(0,r.zG)(e,h.tS((e=>h.G({...e,toast:h.YP}))))))})))}_handleActions(){return this.actions.pipe(s.b((e=>{this._state.modify((t=>(0,r.zG)(t,h.tS((t=>{switch(e.kind){case"trackingButtonClick":return"available"===t.trackingState?(0,r.zG)(t.popup,h.hX((e=>"optIn"===e)),h.WG)?h.G({...t,popup:h.YP,optInPopupWasClosedOnce:!0}):(this._gnar.hwrOptInPopupShow(this._documentId),h.G({...t,popup:h.G("optIn")})):h.G({...t,trackingButtonExpanded:!0,toast:h.YP});case"trackingButtonClickAway":case"trackingButtonCloseClick":case"viewReport":return h.G({...t,trackingButtonExpanded:!1});case"pause":return h.G({...t,trackingState:"paused"});case"resume":case"start":return h.G({...t,trackingState:"tracking"});case"closeOptInPopup":return this._gnar.hwrOptInPopupClose(this._documentId),h.G({...t,trackingState:"newDocument",optInPopupWasClosedOnce:!0,trackingButtonExpanded:!1,popup:h.YP,toast:h.G("optedIn")});case"optOut":return h.G({...t,trackingState:"optedOut",optInPopupWasClosedOnce:!0,trackingButtonExpanded:!1,popup:h.YP,toast:h.G("optedOut")});case"optIn":return h.G({...t,trackingState:"newDocument",optInPopupWasClosedOnce:!0,trackingButtonExpanded:!0,popup:h.YP,toast:h.G("optedIn")});case"enableForDomain":return h.G({...t,trackingState:e.isNewDocument?"tracking":t.trackingState});case"resetForDomain":case"toastHover":return h.G(t);case"optOutToastOkClick":case"dismissToast":case"clipboardWarningResult":return h.G({...t,toast:h.YP});case"clipboardRequestResult":return"allow"===e.result?h.G({...t,popup:h.YP}):h.G({...t,popup:h.YP,toast:h.G("clipboardWarning")});case"giveFeedback":return this._gnar.hwrGiveFeedbackButtonClick(this._documentId,this._domain),h.G({...t,popup:h.G("feedback")});case"feedbackPopupClose":return h.G({...t,popup:h.YP});case"feedbackSubmit":return this._gnar.hwrFeedbackSubmit(this._documentId,this._domain,e.feedback),h.G(t);default:(0,m.L0)(e)}})))))})))}_handleErrors(){return this.errors.pipe(s.b((e=>{this._state.modify((t=>(0,r.zG)(t,h.tS((t=>{switch(e.kind){case"reportGenerationFailed":return h.G({...t,toast:h.G("reportGenerationFailed")});case"databaseCorrupted":return h.G({...t,toast:h.G("storageDatabaseCorrupted")});case"serverError":return h.G({...t,toast:h.G("storageServerError"),trackingState:"paused"});case"unrecoverableError":return h.G({...t,toast:h.G("storageUnrecoverableError"),trackingState:"paused"})}})))))})))}_handleEvents(){return this._events.pipe(c.h((e=>"clipboardAccessRequested"===e.kind)),s.b((e=>{this._state.modify((e=>(0,r.zG)(e,h.tS((e=>h.G({...e,popup:h.G("clipboardAccess"),toast:h.YP}))))))})))}view(){return Ae.createElement(Pe.w,null,Ae.createElement(Fe.L,{chunkName:"humanWritingReport"},Ne.UI.mount(vn,(e=this,Ne.Z.composeUnion({None:()=>D.of(null),Some:Ne.Z.composeKnot({value:Ne.Z.composeKnot({root:()=>e.tButtonPosition,trackingButton:(t=e.state,n=e.actions,Ne.Z.composeUnion({None:()=>D.of(null),Some:Ne.Z.composeKnot({value:An(t,n)})},(()=>t.pipe(Le.cp((({trackingState:e})=>"optedOut"===e?D.of(h.YP):D.of(h.G(e)))))))),popup:xn(e.state,e.actions),toast:En(e.state,e.actions)})})},(()=>e.state))))));var e,t,n}dispose(){this._subs.unsubscribe()}}var Ln=n(70610);const Dn=()=>u.E,Mn=()=>{const e=(0,Ln.CI)(document);return e?x.R(e,"keydown"):u.E};class Rn{constructor(e){this._deps=e,this._subscriptions=new a.w,this._disposables=p.h.create([]),this._listener=p.h.create(h.YP),this._ui=p.h.create(h.YP),this._checkPermissions=new i.xQ,this.isActive=this._listener.view((e=>h.pC(e))),this._domain=e.CSState.view("page").view("domain").get(),this._subscriptions.add(this._handleCheckPermissions(this._checkPermissions).subscribe()),this._subscriptions.add(this._handleStateChanges(e.CSState).subscribe()),this._subscriptions.add(this._handleUIActions(this._deps.uiActions).subscribe()),this._subscriptions.add(this._handleFeatureEvents(this._deps.events).subscribe()),this._subscriptions.add(this._logStartedTracking(this._deps.uiActions,this._deps.events).subscribe()),this._subscriptions.add(this._handleErrors(this._deps.errors).subscribe())}_handleStateChanges(e){return e.view("page").view((({enabled:e,humanWritingReport:t})=>({enabled:e,humanWritingReport:t}))).pipe(o.U((({enabled:e,humanWritingReport:t})=>{if(e)if(t)switch(t.kind){case"available":case"optedOut":this._checkInitUI("optedOut"===t.kind),this._disposeListener();break;case"enabled":this._checkInitUI(),this._checkInitListener(),(0,f.Ng)(this._deps.documentId,this._domain,t)?(this._checkPermissions.next(),this._startTracking()):this._stopTracking();break;case"disabled":this._disposeListener(),this._disposeUI();break;default:(0,m.L0)(t)}else this._deps.csToBgActions.hwrSetInitial(this._deps.onForNewUsers);else this._disposeUI(),this._disposeListener()})))}_handleUIActions(e){return e.pipe(o.U((e=>{switch(e.kind){case"trackingButtonClick":this._deps.gnar.hwrButtonClick(this._deps.documentId);break;case"closeOptInPopup":this._deps.csToBgActions.hwrSetEnabled(!0);break;case"start":case"resume":this._deps.csToBgActions.hwrStartTracking({documentId:this._deps.documentId,domain:this._domain});break;case"enableForDomain":this._deps.gnar.hwrTrackingEnableForDomain(this._deps.documentId,this._domain),this._deps.csToBgActions.hwrStartTrackingDomain({documentId:this._deps.documentId,domain:this._domain});break;case"resetForDomain":this._deps.csToBgActions.hwrStopTrackingDomain({documentId:this._deps.documentId,domain:this._domain});break;case"pause":this._deps.gnar.hwrTrackingPause(this._deps.documentId),this._deps.csToBgActions.hwrStopTracking({documentId:this._deps.documentId,domain:this._domain});break;case"optOut":this._deps.gnar.hwrFeatureOptOut(this._deps.documentId),this._deps.csToBgActions.hwrOptOut();break;case"optIn":this._deps.gnar.hwrFeatureOptIn(this._deps.documentId),this._deps.csToBgActions.hwrOptIn();break;case"viewReport":this._deps.gnar.hwrReportButtonClick(this._deps.documentId),this._viewReport()}})))}_handleErrors(e){return e.pipe(s.b((e=>{switch(e.kind){case"serverError":case"unrecoverableError":this._deps.csToBgActions.hwrStopTracking({documentId:this._deps.documentId,domain:this._domain})}})))}_logStartedTracking(e,t){return e.pipe(c.h((({kind:e})=>"start"===e||"resume"===e)),o.U((({kind:e})=>"resume"===e)),l.w((e=>t.pipe(c.h((({kind:e})=>"knownStateMismatch"===e||"knownStateMatch"===e)),o.U((t=>({event:t,isResume:e})))))),d.q(1),s.b((({event:e,isResume:t})=>{"knownStateMismatch"===e.kind?this._deps.gnar.hwrTrackingStart(this._deps.documentId,t,e.lengthDifference):this._deps.gnar.hwrTrackingStart(this._deps.documentId,t,0)})))}_handleFeatureEvents(e){return e.pipe(s.b((e=>{switch(e.kind){case"sourcedTextAdded":this._deps.gnar.hwrKnownSourcePaste(this._deps.documentId,e.sourceDomain,e.textLength,e.promptDetected);break;case"unknownSourceTextAdded":this._deps.gnar.hwrUnknownSourcePaste(this._deps.documentId,e.textLength);break;case"sourceAdded":this._deps.gnar.hwrKnownSourceDetect(e.sourceDomain,e.textLength,!1)}})))}_checkInitUI(e=!1){this._ui.modify((t=>(0,r.zG)(t,h.wp((()=>{const t=new Bn(this._deps.CSState,this._deps.uiActions,this._deps.errors,this._deps.events,this._deps.documentId,this._deps.gnar,this._getTButtonPositionSource()),n=_.V.get({monitorAs:"human-writing-report"}).inject(y.EM.fromDocument(self.document,"grammarly-human-writing-report"),y.zs.appendChild(self.document.documentElement),C.G7.showWhenLoaded(t.view()));return!e&&this._deps.gnar.hwrButtonShow(this._deps.documentId),h.G({viewModel:t,dispose:()=>{n.dispose(),t.dispose()}})})))))}_getTButtonPositionSource(){return(0,k.Lu)()?We:je}_getKeyboardEventsSource(){return(0,k.Lu)()?Mn:Dn}_startTracking(){(0,r.zG)(this._listener.get(),h.UI((e=>{e.startTracking()})))}_stopTracking(){(0,r.zG)(this._listener.get(),h.UI((e=>{e.stopTracking()})))}_checkInitListener(){this._listener.modify((e=>(0,r.zG)(e,h.wp((()=>h.G(new Te(this._deps.documentId,this._deps.alertsState,this._deps.textObserver,this._deps.selectionSource,this._deps.CSState,this._deps.replacementListener,this._deps.events,this._deps.encryptionClient,this._deps.errors,this._getKeyboardEventsSource()(),(0,v.OB)())))))))}_handleCheckPermissions(e){return e.pipe(l.w((()=>(0,v.OB)().bgRpc.api.isPermissionGranted(g.d.clipboardRead))),c.h((e=>!e)),o.U((()=>{const e=this._deps.CSState.view("page","humanWritingReport").get();return"enabled"===(null==e?void 0:e.kind)&&void 0===(null==e?void 0:e.deniedClipboardAccessSince)})),c.h(Boolean),s.b((()=>{this._deps.events.next({kind:"clipboardAccessRequested"})})),l.w((()=>this._deps.uiActions.pipe(c.h((e=>"clipboardRequestResult"===e.kind&&"allow"===e.result||"clipboardWarningResult"===e.kind)),o.U((e=>"allow"===e.result)),d.q(1)))),l.w((e=>e?(this._deps.gnar.hwrClipboardPermissionRequest(this._deps.documentId),(0,v.OB)().bgRpc.api.requestGrantPermission(g.d.clipboardRead)):(this._deps.gnar.hwrClipboardPermissionDeny(this._deps.documentId),this._deps.csToBgActions.hwrDenyClipboardAccess(),u.E))),s.b((e=>{e?this._deps.gnar.hwrClipboardPermissionAllow(this._deps.documentId):(this._deps.gnar.hwrClipboardPermissionDeny(this._deps.documentId),this._deps.csToBgActions.hwrDenyClipboardAccess())})))}_viewReport(){(0,r.zG)(this._listener.get(),h.UI((async e=>{try{const t=await e.getReportableDocument();try{const e=await this._deps.backendClient.generateReport(t);self.open(e,"_blank")}catch(e){let t="Unknown error";"string"==typeof(null==e?void 0:e.message)?t=e.message:"string"==typeof e&&(t=e),(0,b.Tb)().humanWritingReport.error("reportGenerationFailed",JSON.stringify({documentId:this._deps.documentId,error:t})),this._deps.errors.next({kind:"reportGenerationFailed"})}}catch(e){(0,b.Tb)().humanWritingReport.error("reportGenerationFailed",JSON.stringify({documentId:this._deps.documentId,error:"Can't get reportable document from listener"})),this._deps.errors.next({kind:"reportGenerationFailed"})}})))}_disposeUI(){this._ui.modify((e=>(0,r.zG)(e,h.tS((e=>(e.dispose(),h.YP))))))}_disposeListener(){this._listener.modify((e=>(0,r.zG)(e,h.tS((e=>(e.dispose(),h.YP))))))}dispose(){this._subscriptions.unsubscribe(),this._disposeUI(),this._disposeListener()}}},24814:(e,t,n)=>{if(n.r(t),n.d(t,{CopyContentListener:()=>N}),1388==n.j)var r=n(82823);if(1388==n.j)var a=n(8748);if(1388==n.j)var i=n(65882);if(1388==n.j)var o=n(64965);if(1388==n.j)var s=n(78488);if(1388==n.j)var c=n(65647);if(1388==n.j)var l=n(14765);if(1388==n.j)var d=n(60841);if(1388==n.j)var u=n(17888);if(1388==n.j)var h=n(55446);if(1388==n.j)var m=n(78084);if(1388==n.j)var p=n(22889);if(1388==n.j)var g=n(13195);if(1388==n.j)var f=n(97697);if(1388==n.j)var k=n(44424);if(1388==n.j)var b=n(20715);if(1388==n.j)var v=n(83780);if(1388==n.j)var _=n(64218);if(1388==n.j)var y=n(74857);if(1388==n.j)var C=n(27628);if(1388==n.j)var w=n(90049);if(1388==n.j)var x=n(70989);if(1388==n.j)var S=n(25770);if(1388==n.j)var E=n(8754);if(1388==n.j)var I=n(42818);if(1388==n.j)var T=n(88241);if(1388==n.j)var A=n(85615);if(1388==n.j)var B=n(50439);if(1388==n.j)var L=n(16692);if(1388==n.j)var D=n(77256);if(1388==n.j)var M=n(56735);function R(e){return e.length>25?`${e.slice(0,25)}...`:e}class N{constructor(e,t,n){this._env=e,this._featureState=t,this._gnar=n,this._log=T.Y.create("CopyContentListener"),this._subs=new r.w,this._clipboardText=S.h.create(""),this._genAIMatcher=(0,M.O7)(),null==e.browserApi?(this._trackingEnabled=a.E,this._log.debug("CopyContentListener cannot be initialized, browserApi is not available")):(this._store=(0,D.T)((0,A.D)(e.browserApi.preferences)),this._trackingEnabled=i.aj(o.R(document,"visibilitychange").pipe(s.b((()=>{this._log.debug("visibilitychange",document.hidden?"hidden":"visible")})),c.U((()=>!document.hidden)),l.O(!document.hidden)),t).pipe(c.U((([e,t])=>e&&(0,I.sZ)(t))),d.w((e=>e?this._env.bgRpc.api.isPermissionGranted(E.d.clipboardRead):Promise.resolve(!1))),u.shareReplay({bufferSize:1,refCount:!0})),this._subs.add(this._trackingEnabled.subscribe((e=>{this._log.debug(`Tracking enabled: ${e}`)}))),this._subs.add(this._setupTrackingBecameEnabledHandler()),this._subs.add(this._clipboardText.pipe(h.h((e=>e.length>0))).subscribe((e=>this._onClipboardChange(e)))),this._log.debug("CopyContentListener initialized"))}_readClipboard(){return m.P((()=>navigator.clipboard.readText())).pipe(p.a((e=>e.pipe(g.b(((e,t)=>(0===t&&this._log.debug("Error getting text, will retry",e.message),f.s((()=>t>0),k._(e),b.of(e).pipe(v.g(50))))))))),_.K((e=>(this._log.debug("Error getting text, after one retry, give up for now",e.message),a.E))))}_setupTrackingBecameEnabledHandler(){return this._trackingEnabled.pipe(h.h(Boolean),y.b(0),d.w((()=>this._readClipboard().pipe(s.b((e=>{this._log.debug("Window focused and tracking enabled. Saving Clipboard text:",R(e)),this._clipboardText.set(e)}))))),C.c(this._userActionHandler())).subscribe()}_userActionHandler(){const e={capture:!0,once:!1,passive:!0};return w.T(o.R(self,"mouseup",e),o.R(self,"keyup",e),o.R(self,"copy",e)).pipe(y.b(300),x.M(this._trackingEnabled),h.h((([e,t])=>t)),d.w((()=>this._readClipboard())),s.b((e=>{this._log.debug("User action happened. Saving Clipboard text:",R(e)),this._clipboardText.set(e)})))}_onClipboardChange(e){const t=this._genAIMatcher.getPromptForText(e);t&&this._log.debug("Found genAI prompt for text:",t);this._store.get().then((n=>{const r=n.copiedTextMessage;if(null==r||!(null==r?void 0:r.valid)||(null==r?void 0:r.valid)&&r.copiedText!=e){const n=new L.m;this._log.debug("New clipboard text:",R(e)),this._gnar.hwrKnownSourceDetect(self.location.origin,e.length,Boolean(t)),this._store.set(B.v.make(n.url,n.title,e,t||void 0))}}))}dispose(){this._subs.unsubscribe(),this._genAIMatcher.dispose()}}},16692:(e,t,n)=>{n.d(t,{m:()=>a});var r=n(36226);class a{constructor(){this.location=self.location,this._title=document.title}get url(){return this.location.href}get title(){return this._title}isGoogleDocs(){return"docs.google.com"==this.location.hostname}get documentID(){return this.isGoogleDocs()?(0,r.j)(this.location.href):null}}},56735:(e,t,n)=>{if(n.d(t,{O7:()=>h}),1388==n.j)var r=n(82823);if(1388==n.j)var a=n(36072);if(1388==n.j)var i=n(65647);if(1388==n.j)var o=n(55446);if(1388==n.j)var s=n(25770);if(1388==n.j)var c=n(62617);if(1388==n.j)var l=n(16711);class d{getPromptForText(){return null}dispose(){}}class u{constructor(e,t){this._promptsSelector=e,this._responsesSelector=t,this._pairs=new Map,this._subs=new r.w,this._prompts=new a.xQ,this._pairsOutdated=s.h.create(!0),this._subs.add(this._setupMutationObserver().subscribe((()=>{this._pairsOutdated.set(!0)})))}_searchForPairs(){const e=Array.from(document.querySelectorAll(this._promptsSelector));if(e){const t=Array.from(document.querySelectorAll(this._responsesSelector));t&&t.length===e.length&&e.forEach(((e,n)=>{var r,a;const i=(null===(r=e.textContent)||void 0===r?void 0:r.trim())||null;if(i){const e=(null===(a=t[n].textContent)||void 0===a?void 0:a.trim())||null;e&&this._pairs.set((0,c.Ue)(e),{prompt:i,response:e})}}))}this._pairsOutdated.set(!1)}_setupMutationObserver(){return l.x.create(document,{attributes:!1,subtree:!0,childList:!0}).pipe((0,i.U)((e=>e.filter((e=>e.addedNodes.length>0)).some((e=>Array.from(e.addedNodes).filter((e=>e instanceof HTMLElement)).some((e=>e.matches(this._responsesSelector)||e.querySelector(this._responsesSelector))))))),(0,o.h)(Boolean))}getPromptForText(e){var t;return this._pairsOutdated.get()&&this._searchForPairs(),(null===(t=this._pairs.get((0,c.Ue)(e)))||void 0===t?void 0:t.prompt)||null}dispose(){this._subs.unsubscribe()}}function h(){const e=self.location.hostname;return"chat.openai.com"===e||"chatgpt.com"===e?new u('div[data-message-author-role="user"]','div[data-message-author-role="assistant"]'):"gemini.google.com"===e?new u("div.query-content","div.response-content"):/claude.ai\/chat\//.test(location.href)?new u("div.font-user-message","div.font-claude-message"):/^(www\.)?perplexity\.ai$/.test(location.hostname)?new u(".whitespace-pre-line.break-words","div.prose"):new d}},42818:(e,t,n)=>{n.d(t,{E3:()=>s,MP:()=>i,Ng:()=>a,sZ:()=>o,wg:()=>r});const r={kind:"available",optInPopUpWasClosedAtLeastOnce:!1};function a(e,t,n){if("enabled"===n.kind){const r=n.domainSettings.find((({domain:e})=>e===t));return!!r&&(r.logAllDocuments?!r.pausedDocumentIds.includes(e):r.activeDocumentIds.includes(e))}return!1}function i(e,t,n){var r;if("enabled"===n.kind){const a=n.domainSettings.find((({domain:e})=>e===t));return!!a&&(!!a.logAllDocuments||((null===(r=a.pausedDocumentIds)||void 0===r?void 0:r.includes(e))||a.activeDocumentIds.includes(e)))}return!1}function o(e){return"enabled"===(null==e?void 0:e.kind)&&e.domainSettings.some((e=>e.logAllDocuments?e.logAllDocuments:e.activeDocumentIds.length>0))}function s(e,t){var n,r;return"enabled"===t.kind&&Boolean(null===(r=null===(n=t.domainSettings)||void 0===n?void 0:n.find((({domain:t})=>t===e)))||void 0===r?void 0:r.logAllDocuments)}},62617:(e,t,n)=>{n.d(t,{CZ:()=>l,Hq:()=>i,QY:()=>r,Ue:()=>d,Xw:()=>u,aS:()=>c,fo:()=>g,k4:()=>p});var r,a,i,o=n(18820),s=n(21768);function c(e,t){if(e.length<=t)return e;if(t<=3)return"...";const n=Math.ceil((t-3)/2),r=Math.floor((t-3)/2);return`${e.substring(0,n)}...${e.substring(e.length-r,e.length)}`}function l(e){const t=e.match(/`{3,}[^`]*`{3,}/g);return null==t?e:t.reduce(((e,t)=>e.replace(t,"")),e)}function d(e){return e.replace(/[.,/#!$%^&*;:{}=\-_`~()\s]/g,"").toLowerCase()}function u(e){var t;return(null===(t=/^(hwr:\/\/.+$|https?:\/\/[^/]+)/.exec(e))||void 0===t?void 0:t[1])||"Undetermined"}!function(e){e.getNumInsertedLetters=function(e){return e.ops.reduce(((e,t)=>o.s.isInsertString(t)?e+o.s.getInsertLength(t):e),0)},e.getNumDeletedLetters=function(e){const t=e.ops.filter((e=>o.s.isDelete(e)));let n=0;return t.forEach((e=>{o.s.isDelete(e)&&(n+=e.delete)})),n},e.getSummary=function(e,t){return t.ops.reduce(((t,n)=>{let r=t.summary.retained,a=t.summary.deleted,i=t.summary.inserted,o=t.pointer;return"retain"in n&&(r=`${r}${e.substring(o,o+n.retain)}`,o+=n.retain),"delete"in n&&(a=`${a}${e.substring(o,o+n.delete)}`),"insert"in n&&(i=`${i}${n.insert}`),{pointer:o,summary:{retained:r,deleted:a,inserted:i}}}),{pointer:0,summary:{retained:"",deleted:"",inserted:""}}).summary},e.extractMaximalReplacementString=function(e,t){return t.ops.reduce(((t,n)=>(o.s.isInsertString(n)?t.text=`${t.text}${n.insert}`:o.s.isDelete(n)?t.originalTextPointer+=n.delete:o.s.isRetain(n)&&(t.text.length&&(t.text=`${t.text}${e.substring(t.originalTextPointer,t.originalTextPointer+n.retain)}`),t.originalTextPointer+=n.retain),t)),{text:"",originalTextPointer:0}).text||null},e.singleDelta=function(e,t){if(e===t)return new s.i([]);let n=0;const r=Math.min(e.length,t.length);for(;n<r&&e[n]===t[n];)n++;let a=0;for(;n+a<r&&t[t.length-a-1]===e[e.length-a-1];)a++;const i=e.length-(n+a),o=t.length-(n+a),c=[...n>0?[{retain:n}]:[],...i>0?[{delete:i}]:[],...o>0?[{insert:t.substring(n,n+o)}]:[]];return new s.i(c)},e.isNoTextChangesDelta=function(e){return e.ops.every((e=>o.s.isInsertString(e)?!e.insert.length:!o.s.isDelete(e)||!e.delete))}}(r||(r={})),function(e){e.isTextEqual=function(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;++n)if(e[n].char!=t[n].char)return!1;return!0},e.isContentEqual=function(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;++n)if(e[n].char!=t[n].char||e[n].sourceContentId!=t[n].sourceContentId||e[n].isSelfAuthored!=t[n].isSelfAuthored)return!1;return!0}}(a||(a={})),function(e){e.hasPerLetterTags=function(e){return e.isSelfAuthoredTags.length==e.text.length},e.toLoggableString=function(e){const t=c(e.text,40);return`CopiedContent [text length=${e.text.length}, has per letter tags=$hasPerLetterTags({sourcedContent)}, text=${t}]`},e.eq=function(e,t){if(e.length!==t.length)return!1;const n=e.slice().sort(((e,t)=>e.text.localeCompare(t.text)||e.sourceName.localeCompare(t.sourceName))),r=t.slice().sort(((e,t)=>e.text.localeCompare(t.text)||e.sourceName.localeCompare(t.sourceName)));return n.every(((e,t)=>e.text===r[t].text&&e.sourceName===r[t].sourceName))}}(i||(i={}));const h=new Set(["'","‘","’","＇","ߴ","ߵ"]),m=new Set(['"',"«","»","","“","”","„","‟","‹","›","❮","❯","❝","❞","❛","❜","〝","〞","⹂"]);function p(e,t,n){var a,i,o,s;const c=r.getSummary(e,t);return".."===c.deleted&&"…"===c.inserted&&"."===(null===(a=n[0])||void 0===a?void 0:a.key)||"…"===c.deleted&&"..."===c.inserted&&""===(null===(i=n[0])||void 0===i?void 0:i.key)||"-"===c.deleted&&"–"===c.inserted&&"-"===(null===(o=n[0])||void 0===o?void 0:o.key)||"–"===c.deleted&&"--"===c.inserted&&""===(null===(s=n[0])||void 0===s?void 0:s.key)?1:0}function g(e,t){return!!e.length&&e.split("").every(((e,n)=>{var r,a,i;return void 0!==(null===(r=t[n])||void 0===r?void 0:r.key)&&(a=t[n].key,i=e,1===a.length&&1===i.length&&(a===i||"'"===a&&h.has(i)||'"'===a&&m.has(i)))}))}},55362:(e,t,n)=>{n.d(t,{$x:()=>o,F8:()=>g,Go:()=>a,Kt:()=>y,Lq:()=>l,QR:()=>I,Qy:()=>k,Vk:()=>C,Wp:()=>r,XG:()=>i,_m:()=>h,d0:()=>d,f:()=>c,gH:()=>f,gL:()=>w,ij:()=>E,j5:()=>_,jW:()=>p,l$:()=>m,lO:()=>S,os:()=>v,rx:()=>x,uj:()=>u,y1:()=>s,yw:()=>b});const r=".kix-appview-editor",a=".docos-input",i=".docs-texteventtarget-iframe",o=".kix-cursor",s=".kix-cursor-caret",c="#docs-revisions-sidebar",l='#docs-toolbar-mode-switcher[aria-label="Viewing mode"]',d="#docs-toolbar-mode-switcher",u="edit-mode",h="suggest-mode",m="titlebar-mode-indicator-container",p="#titlebar-mode-indicator-container .titlebar-request-access-button",g="#titlebar-mode-indicator-container .kix-titlebar-request-access-button",f="canvas.kix-canvas-tile-content:not(.docs-ui-unprintable *)",k=".kix-rotatingtilemanager:not(.docs-ui-unprintable *)",b=".kix-page-paginated",v=".kix-page-paginated.canvas-first-page",_=".docs-horizontal-ruler",y=".docs-vertical-ruler",C="#fontSizeSelect input",w=".docs-ruler-background",x=".docs-ruler-background-inner",S=".docs-ruler-indent-first-line",E=".modal-dialog.docs-dialog .fatal-error-message",I='#docs-titlebar-share-client-button div[role="button"]'},36226:(e,t,n)=>{n.d(t,{j:()=>a});var r=n(67458);function a(e){const t=e.match(/d\/(.*?)\//);return t?r.createHash("superfasthash").hash(t[1]):null}},74927:(e,t,n)=>{n.d(t,{J:()=>d});var r=n(90023),a=n(49231),i=n(4712),o=n(6662),s=n(78488),c=n(99627),l=n(14482);const d=({onChange:e,labelId:t,className:n,checkboxClassName:d,labelClassName:u,checked:h,children:m,disabled:p,useDS:g,dataGrammarlyPart:f="ui-kit-checkbox",tabIndex:k=0,onMount:b=r.Q1})=>{const[v,_]=a.useState(null!=h&&h);a.useEffect((()=>{_(Boolean(h))}),[h]);const y=t=>{t.preventDefault(),t.stopPropagation(),_(!v),null==e||e(!v)},{ref:C,onMount:w}=i.P.useElWatcher();return a.useEffect((()=>{const e=C.pipe(o.oA,s.b(b)).subscribe();return()=>e.unsubscribe()}),[]),a.createElement("div",{"data-grammarly-part":f,...(0,c.Sh)(l.checkboxContainer,n)},a.createElement("div",{...(0,c.Sh)(l.checkbox,d,v?l.checkboxChecked:null,g?l.checkboxDS:null),role:"checkbox","aria-checked":v,tabIndex:k,"aria-labelledby":t,onKeyDown:e=>{" "===e.key&&y(e)},onClick:p?r.Q1:y,ref:w},v?a.createElement("div",{className:l.checkboxCheckmark}):null),a.createElement("label",{id:t,onClick:y,className:u},m))}},65152:(e,t,n)=>{n.d(t,{E:()=>o});var r=n(49231),a=n(99627),i=n(17345);const o=({options:e,onChange:t=(()=>null),ariaLabel:n,className:o})=>{const s=[],[c,l]=r.useState(null);r.useEffect((()=>{var n;null!==c&&(null===(n=s[c])||void 0===n||n.focus()),t(null!==c?e[c].value:null)}),[c]);const d=null!==c?e[c]:null;return r.createElement("div",{"data-grammarly-part":"ui-kit-radio-group",className:o},r.createElement("div",{className:i.radioGroup,role:"radiogroup","aria-label":n,onKeyDown:t=>{if(" "!==t.key||d){if("ArrowRight"===t.key||"ArrowDown"===t.key){t.preventDefault(),t.stopPropagation();l(((c||0)+1)%e.length)}else if("ArrowLeft"===t.key||"ArrowUp"===t.key){t.preventDefault(),t.stopPropagation();const n=(c||0)-1;l(n<0?e.length-1:n)}}else t.preventDefault(),t.stopPropagation(),l(0)}},e.map(((e,t)=>{const n=(null==d?void 0:d.value)===e.value,o=0===t;return r.createElement("div",{key:e.value,...(0,a.Sh)(i.radioGroupOption,n?i.radioGroupOptionSelected:null),role:"radio",tabIndex:n||o&&!d?0:-1,"aria-checked":n,onClick:e=>{e.preventDefault(),e.stopPropagation(),l(t)},ref:e=>s.push(e)},e.render())}))))}},26664:(e,t,n)=>{n.d(t,{z:()=>h});var r=n(49231),a=n(64151);const i=({children:e,style:t,dataGrammarlyPart:n="ui-kit-iframe",...i})=>{const[o,s]=r.useState(null),c=r.useCallback((e=>{var t,n;let r=null;"contentDocument"in e.target&&(r=null!==(n=null===(t=e.target.contentDocument)||void 0===t?void 0:t.body)&&void 0!==n?n:null),s(r),r&&(r.style.margin="0",r.style.height="100vh",r.style.overflowY="hidden")}),[]);return r.createElement("iframe",{...i,style:{border:"none",...t},onLoad:c,srcDoc:"<html><body></body></html>","data-grammarly-part":n},o&&(0,a.createPortal)(e,o))};var o=n(36425),s=n(70632),c=n.n(s),l=n(50293),d=n(90522);const u=({placeholder:e,ariaLabel:t,onChange:n})=>{const[a,i]=r.useState("");return r.useEffect((()=>{n(a)}),[a]),r.createElement(r.Fragment,null,r.createElement(o.b,null,c().__css),r.createElement("div",{role:"textbox",className:c().textBox,contentEditable:!0,onInput:e=>{i(e.target.innerText)},"data-placeholder":e,"aria-placeholder":e,"aria-label":t}))},h=({placeholder:e,onChange:t,ariaLabel:n,iframeTitle:a,className:o})=>(0,l.E)().experimentClient.isGateEnabled(d.K.CentralizeStopEventPropagation)?r.createElement("div",{className:o,style:{width:"100%",height:"128px",maxHeight:"inherit"}},r.createElement(u,{onChange:t,ariaLabel:n,placeholder:e})):r.createElement(i,{dataGrammarlyPart:"ui-kit-textbox",className:o,style:{width:"100%",height:"100%"},title:a},r.createElement(u,{onChange:t,ariaLabel:n,placeholder:e}))},62662:(e,t,n)=>{n.d(t,{V:()=>o});var r=n(49231),a=n(63039),i=n(16502);const o=e=>e.isEnabled?r.createElement(i.T,{type:"mini",size:26,className:a.feedbackFormLogoLine}):null},70092:(e,t,n)=>{n.d(t,{b:()=>w});var r=n(49231),a=n(99627),i=n(40359),o=n(63039);const s=({fixSubmitButtonOverflowBottomPadding:e,className:t,...n})=>r.createElement(r.Fragment,null,r.createElement(i.z,{...n,className:null!=t?t:o.feedbackFormSubmitButton},n.children),r.createElement(c,{isEnabled:e})),c=e=>e.isEnabled?r.createElement("div",{className:o.feedbackFormSubmitButtonFixOverflowBottomPadding},r.createElement("div",{className:o.feedbackFormSubmitButtonFixOverflowBottomPaddingChild})):null,l=e=>r.createElement("div",{"data-grammarly-part":"surveys-feedback-form-thank-you",...(0,a.Sh)(o.feedbackFormContainer,o.feedbackFormContainerAlignCenter)},r.createElement("div",{className:o.feedbackFormSuccessMessageTextContainer},r.createElement("div",{className:o.feedbackFormSuccessMessageIcon}),r.createElement("div",{className:o.feedbackFormSuccessMessageTitle},"Thank you!"),r.createElement("div",{className:o.feedbackFormSuccessMessageSubtitle},"Your feedback helps us improve.")),r.createElement(s,{type:"button",kind:"success",onClick:e.onClose},"Done"));var d=n(26664),u=n(74927);const h=e=>e.domain?r.createElement(r.Fragment,null,e.withHelpText&&r.createElement("div",{className:o.feedbackFormShareDomainTitle},"Help improve Grammarly by sharing the domain you’re on:"),r.createElement(u.J,{checked:e.checked,labelId:"feedback-form-share-domain-checkbox",onChange:e.onChange,className:o.feedbackFormShareDomainCheckbox},"Include the domain ",r.createElement("b",null,e.domain)," with my feedback")):null;var m=n(62662);const p=e=>{var t;if(!e.isEnabled)return null;const n=null!==(t=e.title)&&void 0!==t?t:r.createElement("span",null,"How do you like ",r.createElement("br",null)," Grammarly?");return r.createElement("h3",{...(0,a.Sh)(o.feedbackFormTitle,e.isCompact&&o.compact)},n)};var g=n(42530),f=n(65152),k=n(24029),b=n(45321);const v=e=>{const t=[k.B.bad,k.B.ok,k.B.good];return e.isEnabled?r.createElement(r.Fragment,null,r.createElement(f.E,{ariaLabel:"Feedback Score",options:t.map((e=>({value:e,render:()=>r.createElement("div",{className:b.feedbackFormOption},r.createElement("div",{...(0,a.Sh)(b.feedbackFormOptionIcon,_(e))}),r.createElement("div",null,function(e){switch(e){case k.B.bad:return"I dislike it";case k.B.ok:return"It’s OK";case k.B.good:return"I like it";default:(0,g.vE)(e)}}(e)))}))),onChange:e.onChange,...(0,a.Sh)(o.feedbackFormScore,e.compactDisplay&&o.compact)}),!e.hideTextBoxTitle&&r.createElement("div",{className:o.feedbackFormTextBoxTitle},"Anything we can improve?")):null};function _(e){switch(e){case k.B.bad:return b.feedbackFormOptionIconDisheartening;case k.B.ok:return b.feedbackFormOptionIconNeutral;case k.B.good:return b.feedbackFormOptionIconSmiling;default:(0,g.vE)(e)}}const y=e=>{var t,n,i,c;const[l,u]=r.useState(null),[g,f]=r.useState(""),[k,b]=r.useState(null!==(t=e.domainSharedByDefault)&&void 0!==t&&t);return r.createElement("form",{"data-grammarly-part":"surveys-feedback-form-fields",...(0,a.Sh)(o.feedbackFormContainer,"center"===e.align&&o.feedbackFormContainerAlignCenter)},r.createElement("div",{className:o.feedbackFormFields},r.createElement(m.V,{isEnabled:!e.hideLogo}),r.createElement(p,{isEnabled:!e.hideTitle,title:e.title,isCompact:null!==(n=e.compactDisplay)&&void 0!==n&&n}),r.createElement(v,{isEnabled:e.withScore,compactDisplay:e.compactDisplay,hideTextBoxTitle:e.hideTextBoxTitle,onChange:u}),r.createElement(d.z,{onChange:f,placeholder:null!==(i=e.placeholderText)&&void 0!==i?i:"Your thoughts here",ariaLabel:"Feedback Text",iframeTitle:"Feedback text field",...(0,a.Sh)(o.feedbackFormTextBox,e.compactDisplay&&o.compact)}),r.createElement(h,{domain:e.domain,checked:e.domainSharedByDefault,withHelpText:!e.hideDomainHelpText,onChange:b})),r.createElement(s,{type:"submit",kind:null!==(c=e.submitButtonKind)&&void 0!==c?c:"success",disabled:e.withScore?!l:!g,fixSubmitButtonOverflowBottomPadding:e.fixSubmitButtonOverflowBottomPadding,onClick:t=>{t.preventDefault();const n=k?e.domain:void 0;e.withScore&&l?e.onSubmit({score:l,text:g,domain:n}):!e.withScore&&g&&e.onSubmit({text:g,domain:n})}},"Submit"))};var C=n(95320);const w=({hideLogo:e=!1,align:t="center",fixSubmitButtonOverflowBottomPadding:n=!1,showPostSubmitScreen:a=!0,...i})=>{const[o,s]=r.useState(!1),c=o&&a;return r.createElement("div",{style:i.style,"data-grammarly-part":"surveys-feedback-form",role:"region","aria-label":"Provide feedback","aria-live":"polite"},c?r.createElement(l,{fixSubmitButtonOverflowBottomPadding:n,onClose:i.onClose}):r.createElement(y,{...i,hideLogo:e,align:t,fixSubmitButtonOverflowBottomPadding:n,onSubmit:e=>{i.withScore?((0,C.n8)(e),i.onSubmit(e)):((0,C.TY)(e),i.onSubmit(e)),s(!0)}}))}},24029:(e,t,n)=>{var r;n.d(t,{B:()=>r}),function(e){e.bad="bad",e.ok="ok",e.good="good"}(r||(r={}))},95320:(e,t,n)=>{function r(e){return"score"in e}function a(e){if(!r(e))throw new Error("Received unexpected feedback form data without score")}function i(e){if(r(e))throw new Error("Received unexpected feedback form data with score")}n.d(t,{TY:()=>i,dK:()=>r,n8:()=>a})},85615:(e,t,n)=>{n.d(t,{D:()=>r});const r=e=>({getAll:async()=>await e.getAll(),get:async t=>await e.get(t),patch:async t=>await e.set(t),changes:e.changes})},50439:(e,t,n)=>{var r;n.d(t,{v:()=>r}),function(e){e.make=function(e,t,n,r){return{valid:!0,copiedText:n,sourceURL:e,sourceName:t,userPrompt:r}}}(r||(r={}))},98544:(e,t,n)=>{var r=n(42663),a=n(2963)(r);a.push([e.id,"._z3YOv-textBox{font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#0e101a;font-size:14px;line-height:21px;font-feature-settings:'ss03' on;background:#f9faff;border:1px solid #e7e9f5;box-sizing:border-box;border-radius:4px;padding:10px 8px;overflow-y:auto;cursor:text;width:100%;height:100%;}._z3YOv-textBox:empty:before{font-feature-settings:'ss03' on;font-family:Inter,sans-serif;font-style:normal;font-weight:normal;color:#6d758d;font-size:14px;line-height:21px;content:attr(data-placeholder)}",""]),a.locals={textBox:"_z3YOv-textBox"},e.exports=a},27645:e=>{e.exports={accordionContent:"RZ1tY",shown:"Rodx_",accordionHeader:"zZM6o",accordionItem:"SVcPo",accordionRoot:"ieqWq",accordionTrigger:"lQxeR",linkIcon:"oS7tX",headerContainer:"iMmjP",accordionIcon:"jaZE7",rotate:"Rbcv_"}},14482:e=>{e.exports={checkboxContainer:"Te37e",checkbox:"mFHkX",checkboxDS:"DdH2q",checkboxChecked:"JhHnz",checkboxCheckmark:"zShXt",spin:"tww6q"}},17345:e=>{e.exports={radioGroup:"KAzfW",radioGroupOption:"WkjDU",radioGroupOptionSelected:"onilo"}},63039:e=>{e.exports={feedbackFormContainer:"kjElf",feedbackFormContainerAlignCenter:"hkEx2",feedbackFormFields:"Ua5wJ",feedbackFormTitle:"GnQ_a",feedbackFormTextBoxTitle:"kWEW0",feedbackFormLogoLine:"osGQI",compact:"b7yYp",feedbackFormScore:"ZOSRK",feedbackFormTextBox:"l8New",feedbackFormShareDomainTitle:"Qbnj_",feedbackFormShareDomainCheckbox:"VBCx1",feedbackFormSubmitButton:"tYYGU",feedbackFormSubmitButtonFixOverflowBottomPadding:"Opd8X",feedbackFormSubmitButtonFixOverflowBottomPaddingChild:"QKLT7",feedbackFormSuccessMessageTextContainer:"ARBzt",feedbackFormSuccessMessageIcon:"kJIzg",feedbackFormSuccessMessageTitle:"iXQnf",feedbackFormSuccessMessageSubtitle:"Ydufo",spin:"Vv6WG"}},45321:e=>{e.exports={feedbackFormOption:"sp8vS",feedbackFormOptionIcon:"eH6DL",feedbackFormOptionIconDisheartening:"DhaWh",feedbackFormOptionIconNeutral:"BS_8d",feedbackFormOptionIconSmiling:"dUZNd",spin:"uouSO"}}}]);